<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Creating an application with continuous delivery in the Lambda console - AWS Lambda</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="applications-tutorial" /><meta name="default_state" content="applications-tutorial" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/applications-tutorial.html" /><meta name="description" content="You can use the Lambda console to create an application with an integrated continuous delivery pipeline. With continuous delivery, every change that you push to your source control repository triggers a pipeline that builds and deploys your application automatically. The Lambda console provides starter projects for common application types with Node.js sample code and templates that create supporting resources." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Lambda" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="" /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/applications-tutorial.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lambda/latest/dg/applications-tutorial.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lambda/latest/dg/applications-tutorial.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lambda/latest/dg/applications-tutorial.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lambda/latest/dg/applications-tutorial.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/applications-tutorial.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/applications-tutorial.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lambda/latest/dg/applications-tutorial.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lambda/latest/dg/applications-tutorial.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lambda/latest/dg/applications-tutorial.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lambda/latest/dg/applications-tutorial.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lambda/latest/dg/applications-tutorial.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lambda/latest/dg/applications-tutorial.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/applications-tutorial.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/applications-tutorial.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/applications-tutorial.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/applications-tutorial.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lambda/latest/dg/applications-tutorial.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lambda/latest/dg/applications-tutorial.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/lambda/latest/dg/applications-tutorial.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/applications-tutorial.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/applications-tutorial.html" hreflang="x-default" /><meta name="feedback-item" content="Lambda" /><meta name="this_doc_product" content="AWS Lambda" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'lambda'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Creating an application with continuous delivery in the Lambda console" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Creating an application with continuous delivery in the Lambda console - AWS Lambda</title><meta name="pdf" content="/pdfs/lambda/latest/dg/lambda-dg.pdf#applications-tutorial" /><meta name="rss" content="lambda-updates.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=186" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/applications-tutorial.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/applications-tutorial.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/applications-tutorial.html" /><meta name="keywords" content="Lambda,AWS Lambda,serverless,serverless applications,cloud computing" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Lambda",
        "item" : "https://docs.aws.amazon.com/lambda/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "AWS Lambda applications",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/deploying-lambda-apps.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Creating an application with continuous delivery in the Lambda console",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/deploying-lambda-apps.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/lambda/latest/dg/lambda-dg.pdf#applications-tutorial" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/lambda/index.html">AWS Lambda</a><a href="welcome.html">Developer Guide</a></div><div id="page-toc-src"><a href="#applications-tutorial-prepare">Prerequisites</a><a href="#applications-tutorial-wizard">Create an application</a><a href="#applications-tutorial-invoke">Invoke the function</a><a href="#applications-tutorial-update">Add an AWS resource</a><a href="#applications-tutorial-permissions">Update the permissions boundary</a><a href="#applications-tutorial-code">Update the function code</a><a href="#applications-tutorial-nextsteps">Next steps</a><a href="#applications-tutorial-troubleshooting">Troubleshooting</a><a href="#applications-tutorial-cleanup">Clean up</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="applications-tutorial">Creating an application with continuous delivery in the Lambda
      console</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>You can use the Lambda console to create an application with an integrated continuous delivery pipeline. With
    continuous delivery, every change that you push to your source control repository triggers a pipeline that builds
    and deploys your application automatically. The Lambda console provides starter projects for common application types
    with Node.js sample code and templates that create supporting resources.</p><p>In this tutorial, you create the following resources.</p><div class="itemizedlist">
     
     
     
     
     
     
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p><b>Application</b> – A Node.js Lambda function, build specification, and
        AWS Serverless Application Model (AWS SAM) template.</p>
    </li><li class="listitem">
      <p><b>Pipeline</b> – An AWS CodePipeline pipeline that connects the other resources
        to enable continuous delivery.</p>
    </li><li class="listitem">
      <p><b>Repository</b> – A Git repository in AWS CodeCommit. When you push a change,
        the pipeline copies the source code into an Amazon S3 bucket and passes it to the build project.</p>
    </li><li class="listitem">
      <p><b>Trigger</b> – An Amazon EventBridge (CloudWatch Events) rule that watches the main branch of the
        repository and triggers the pipeline.</p>
    </li><li class="listitem">
      <p><b>Build project</b> – An AWS CodeBuild build that gets the source code from
        the pipeline and packages the application. The source includes a build specification with commands that install
        dependencies and prepare the application template for deployment.</p>
    </li><li class="listitem">
      <p><b>Deployment configuration</b> – The pipeline's deployment stage defines a
        set of actions that take the processed AWS SAM template from the build output, and deploy the new version with
        AWS CloudFormation.</p>
    </li><li class="listitem">
      <p><b>Bucket</b> – An Amazon Simple Storage Service (Amazon S3) bucket for deployment artifact
        storage.</p>
    </li><li class="listitem">
      <p><b>Roles</b> – The pipeline's source, build, and deploy stages have IAM
        roles that allow them to manage AWS resources. The application's function has an <a href="./lambda-intro-execution-role.html">execution role</a> that allows it to upload logs and can be extended
        to access other services.</p>
    </li></ul></div><p>Your application and pipeline resources are defined in AWS CloudFormation templates that you can customize and extend. Your
    application repository includes a template that you can modify to add Amazon DynamoDB tables, an Amazon API Gateway API, and other
    application resources. The continuous delivery pipeline is defined in a separate template outside of source control
    and has its own stack.</p><p>The pipeline maps a single branch in a repository to a single application stack. You can create additional
    pipelines to add environments for other branches in the same repository. You can also add stages to your pipeline
    for testing, staging, and manual approvals. For more information about AWS CodePipeline, see <a href="https://docs.aws.amazon.com/codepipeline/latest/userguide/welcome.html">What is AWS CodePipeline</a>.</p><div class="highlights" id="inline-topiclist"><h6>Sections</h6><ul><li><a href="#applications-tutorial-prepare">Prerequisites</a></li><li><a href="#applications-tutorial-wizard">Create an application</a></li><li><a href="#applications-tutorial-invoke">Invoke the function</a></li><li><a href="#applications-tutorial-update">Add an AWS resource</a></li><li><a href="#applications-tutorial-permissions">Update the permissions boundary</a></li><li><a href="#applications-tutorial-code">Update the function code</a></li><li><a href="#applications-tutorial-nextsteps">Next steps</a></li><li><a href="#applications-tutorial-troubleshooting">Troubleshooting</a></li><li><a href="#applications-tutorial-cleanup">Clean up</a></li></ul></div>
    <h2 id="applications-tutorial-prepare">Prerequisites</h2>
     <p>This tutorial assumes that you have some knowledge of basic Lambda operations and the Lambda console. If you
      haven't already, follow the instructions in <a href="./getting-started.html#getting-started-create-function">Create a Lambda function with the console</a> to create your first Lambda function.</p>
     <p>To complete the following steps, you need the <a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html">AWS Command Line Interface (AWS CLI) version 2</a>. Commands and the expected output are listed in separate blocks:</p>
    <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight"><code class="userinput">aws --version</code></code></pre>
    <p>You should see the following output:</p>
    <pre class="programlisting"><div class="code-btn-container"></div><code class="">aws-cli/2.0.57 Python/3.7.4 Darwin/19.6.0 exe/x86_64</code></pre>
    <p>For long commands, an escape character (<code class="code">\</code>) is used to split a command over multiple lines.</p>
    <p>On Linux and macOS, use your preferred shell and package manager.</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>In Windows, some Bash CLI commands that you commonly use with Lambda (such as <code class="code">zip</code>) are not supported by the operating system's built-in terminals. 
    To get a Windows-integrated version of Ubuntu and Bash, <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" rel="noopener noreferrer" target="_blank"><span>install the Windows Subsystem for Linux</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.
     Example CLI commands in this guide use Linux formatting. Commands which include inline JSON documents must be reformatted if you are using the Windows CLI.
    </p></div></div>
    
    <p>This tutorial uses CodeCommit for source control. To set up your local machine to access and update application
      code, see <a href="https://docs.aws.amazon.com/codecommit/latest/userguide/setting-up.html">Setting up</a> in the
        <em>AWS CodeCommit User Guide</em>.</p>
   
    <h2 id="applications-tutorial-wizard">Create an application</h2>
    
    <p>Create an application in the Lambda console. In Lambda, an application is an AWS CloudFormation stack with a Lambda function
      and any number of supporting resources. In this tutorial, you create an application that has a function and its
      execution role.</p>
    <div class="procedure"><h6>To create an application</h6><ol><li> <p>Open the Lambda console <a href="https://console.aws.amazon.com/lambda/home#/applications" rel="noopener noreferrer" target="_blank"><span>Applications page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p> </li><li>
        <p>Choose <b>Create application</b>.</p>
      </li><li>
        <p>Choose <b>Author from scratch</b>.</p>
      </li><li>
        <p>Configure application settings.</p>
        <div class="itemizedlist">
           
           
          
           
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p><b>Application name</b> – <code class="userinput">my-app</code>.</p>
          </li><li class="listitem">
            <p><b>Runtime</b> – <b>Node.js 14.x</b>.</p>
          </li><li class="listitem">
            <p><b>Source control service</b> – <b>CodeCommit</b>.</p>
          </li><li class="listitem">
            <p><b>Repository name</b> – <code class="userinput">my-app-repo</code>.</p>
          </li><li class="listitem">
            <p><b>Permissions</b> – <b>Create roles and permissions
              boundary</b>.</p>
          </li></ul></div>
      </li><li>
        <p>Choose <b>Create</b>.</p>
      </li></ol></div>
    
    <p>Lambda creates the pipeline and related resources and commits the sample application code to the Git
      repository. As resources are created, they appear on the overview page.</p>
    <div class="mediaobject">
       
        <img src="/images/lambda/latest/dg/images/application-create-resources.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Starter application resources during deployment.&#xA;      " style="max-width:100%" />
       
       
    </div>
    <p>The <b>Infrastructure</b> stack contains the repository, build project, and other resources that
      combine to form a continuous delivery pipeline. When this stack finishes deploying, it in turn deploys the
      application stack that contains the function and execution role. These are the application resources that appear
      under <b>Resources</b>.</p>
   
    <h2 id="applications-tutorial-invoke">Invoke the function</h2>
    
    <p>When the deployment process completes, invoke the function from the Lambda console.</p>
    <div class="procedure"><h6>To invoke the application's function</h6><ol><li> <p>Open the Lambda console <a href="https://console.aws.amazon.com/lambda/home#/applications" rel="noopener noreferrer" target="_blank"><span>Applications page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p> </li><li>
        <p>Choose <b>my-app</b>.</p>
      </li><li>
        <p>Under <b>Resources</b>, choose <b>helloFromLambdaFunction</b>.</p>
      </li><li>
        <p>Choose <b>Test</b>.</p>
      </li><li>
        <p>Configure a test event.</p>
        <div class="itemizedlist">
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p><b>Event name</b> – <code class="userinput">event</code></p>
          </li><li class="listitem">
            <p><b>Body</b> – <code class="userinput"><span>{</span>}</code></p>
          </li></ul></div>
      </li><li>
        <p>Choose <b>Create</b>.</p>
      </li><li>
        <p>Choose <b>Test</b>.</p>
      </li></ol></div>
    <p>The Lambda console runs your function and displays the result. Expand the <b>Details</b>
      section under the result to see the output and execution details.</p>
    <div class="mediaobject">
       
        <img src="/images/lambda/latest/dg/images/application-create-result.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Output from a test invocation.&#xA;      " style="max-width:100%" />
       
       
    </div>
   
    <h2 id="applications-tutorial-update">Add an AWS resource</h2>
    
    <p>In the previous step, Lambda console created a Git repository that contains function code, a template, and a
      build specification. You can add resources to your application by modifying the template and pushing changes to
      the repository. To get a copy of the application on your local machine, clone the repository.</p>
    <div class="procedure"><h6>To clone the project repository</h6><ol><li> <p>Open the Lambda console <a href="https://console.aws.amazon.com/lambda/home#/applications" rel="noopener noreferrer" target="_blank"><span>Applications page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p> </li><li>
        <p>Choose <b>my-app</b>.</p>
      </li><li>
        <p>Choose <b>Code</b>.</p>
      </li><li>
        <p>Under <b>Repository details</b>, copy the HTTP or SSH repository URI, depending on the
          authentication mode that you configured during <a href="#applications-tutorial-prepare">setup</a>.</p>
      </li><li>
        <p>To clone the repository, use the <code class="code">git clone</code> command.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">git clone <code class="replaceable">ssh://git-codecommit.us-east-2.amazonaws.com/v1/repos/my-app-repo</code></code></code></pre>
      </li></ol></div>
    
    <p>To add a DynamoDB table to the application, define an <code class="code">AWS::Serverless::SimpleTable</code> resource in the
      template.</p>
    <div class="procedure"><h6>To add a DynamoDB table</h6><ol><li>
        <p>Open <code>template.yml</code> in a text editor.</p>
      </li><li>
        <p>Add a table resource, an environment variable that passes the table name to the function, and a
          permissions policy that allows the function to manage it.</p>
        <div class="example"><h6>Example template.yml - resources</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">...
Resources:
  <code class="userinput">ddbTable:
    Type: AWS::Serverless::SimpleTable
    Properties:
      PrimaryKey:
        Name: id
        Type: String
      ProvisionedThroughput:
        ReadCapacityUnits: 1
        WriteCapacityUnits: 1</code>
  helloFromLambdaFunction:
    Type: <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html">AWS::Serverless::Function</a>
    Properties:
      CodeUri: ./
      Handler: src/handlers/hello-from-lambda.helloFromLambdaHandler
      Runtime: nodejs14.x
      MemorySize: 128
      Timeout: 60
      Description: A Lambda function that returns a static string.
      <code class="userinput">Environment:
        Variables:
          DDB_TABLE: !Ref ddbTable</code>
      Policies:
        <code class="userinput">- DynamoDBCrudPolicy:
            TableName: !Ref ddbTable</code>
        - AWSLambdaBasicExecutionRole</code></pre></div></div>
      </li><li>
        <p>Commit and push the change.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">git commit -am "Add DynamoDB table"</code>
<code class="userinput">git push</code></code></pre>
      </li></ol></div>
    <p>When you push a change, it triggers the application's pipeline. Use the <b>Deployments</b> tab
      of the application screen to track the change as it flows through the pipeline. When the deployment is complete,
      proceed to the next step.</p>
    <div class="mediaobject">
       
        <img src="/images/lambda/latest/dg/images/application-create-deployment.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Monitoring an application deployment in the Lambda console.&#xA;      " style="max-width:100%" />
       
       
    </div>
   
    <h2 id="applications-tutorial-permissions">Update the permissions boundary</h2>
    
    <p>The sample application applies a <em>permissions boundary</em> to its function's execution role.
      The permissions boundary limits the permissions that you can add to the function's role. Without the boundary,
      users with write access to the project repository could modify the project template to give the function
      permission to access resources and services outside of the scope of the sample application.</p>
    
    <p>In order for the function to use the DynamoDB permission that you added to its execution role in the previous
      step, you must extend the permissions boundary to allow the additional permissions. The Lambda console detects
      resources that aren't in the permissions boundary and provides an updated policy that you can use to update
      it.</p>
    <div class="procedure"><h6>To update the application's permissions boundary</h6><ol><li> <p>Open the Lambda console <a href="https://console.aws.amazon.com/lambda/home#/applications" rel="noopener noreferrer" target="_blank"><span>Applications page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p> </li><li>
        <p>Choose your application.</p>
      </li><li>
        <p>Under <b>Resources</b>, choose <b>Edit permissions boundary</b>.</p>
      </li><li>
        <p>Follow the instructions shown to update the boundary to allow access to the new table.</p>
      </li></ol></div>
    <p>For more information about permissions boundaries, see <a href="./permissions-boundary.html">Using permissions boundaries for AWS Lambda applications</a>.</p>
   
    <h2 id="applications-tutorial-code">Update the function code</h2>
    
    <p>Next, update the function code to use the table. The following code uses the DynamoDB table to track the number
      of invocations processed by each instance of the function. It uses the log stream ID as a unique identifier for
      the function instance.</p>
    <div class="procedure"><h6>To update the function code</h6><ol><li>
        <p>Add a new handler named <code>index.js</code> to the <code>src/handlers</code> folder with
          the following content.</p>
        <div class="example"><h6>Example src/handlers/index.js</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">const dynamodb = require('aws-sdk/clients/dynamodb');
const docClient = new dynamodb.DocumentClient();

exports.handler = async (event, context) =&gt; <span>{</span>
    const message = 'Hello from Lambda!';
    const tableName = process.env.DDB_TABLE;
    const logStreamName = context.logStreamName;
    var params = <span>{</span>
        TableName : tableName,
        Key: <span>{</span> id : logStreamName },
        UpdateExpression: 'set invocations = if_not_exists(invocations, :start) + :inc',
        ExpressionAttributeValues: <span>{</span>
            ':start': 0,
            ':inc': 1
        },
        ReturnValues: 'ALL_NEW'
    };
    await docClient.update(params).promise();

    const response = <span>{</span>
        body: JSON.stringify(message)
    };
    console.log(`body: $<span>{</span>response.body}`);
    return response;
}</code></pre></div></div>
      </li><li>
        <p>Open the application template and change the handler value to
          <code class="code">src/handlers/index.handler</code>.</p>
        <div class="example"><h6>Example template.yml</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">...
  helloFromLambdaFunction:
    Type: <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html">AWS::Serverless::Function</a>
    Properties:
      CodeUri: ./
      Handler: <code class="userinput">src/handlers/index.handler</code>
      Runtime: nodejs14.x</code></pre></div></div>
      </li><li>
        <p>Commit and push the change.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">git add . &amp;&amp; git commit -m "Use DynamoDB table"</code>
<code class="userinput">git push</code></code></pre>
      </li></ol></div>
    
    <p>After the code change is deployed, invoke the function a few times to update the DynamoDB table.</p>
    <div class="procedure"><h6>To view the DynamoDB table</h6><ol><li>
        <p>Open the <a href="https://console.aws.amazon.com/dynamodb/home#tables:" rel="noopener noreferrer" target="_blank"><span>Tables page of the DynamoDB
          console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
      </li><li>
        <p>Choose the table that starts with <b>my-app</b>.</p>
      </li><li>
        <p>Choose <b>Items</b>.</p>
      </li><li>
        <p>Choose <b>Start search</b>.</p>
      </li></ol></div>
    <div class="mediaobject">
       
        <img src="/images/lambda/latest/dg/images/application-create-ddbtable.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        A DynamoDB table that shows the number of times an instance of a function has processed an event.&#xA;      " style="max-width:100%" />
       
       
    </div>
    <p>Lambda creates additional instances of your function to handle multiple concurrent invocations. Each log stream
      in the CloudWatch Logs log group corresponds to a function instance. A new function instance is also created when you change
      your function's code or configuration. For more information on scaling, see <a href="./lambda-concurrency.html">Lambda function scaling</a>.</p>
   
    <h2 id="applications-tutorial-nextsteps">Next steps</h2>
    
    <p>The AWS CloudFormation template that defines your application resources uses the AWS Serverless Application Model transform to simplify the syntax
      for resource definitions, and automate uploading the deployment package and other artifacts. AWS SAM also provides a
      command line interface (the AWS SAM CLI), which has the same packaging and deployment functionality as the AWS CLI,
      with additional features specific to Lambda applications. Use the AWS SAM CLI to test your application locally in a
      Docker container that emulates the Lambda execution environment.</p>
    <div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p><a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-install.html">Installing the AWS SAM CLI</a></p>
      </li><li class="listitem">
        <p><a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-test-and-debug.html">Testing and debugging serverless
            applications with AWS SAM</a></p>
      </li><li class="listitem">
        <p><a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-deploying.html">Deploying serverless applications using CI/CD systems with AWS SAM</a></p>
      </li></ul></div>
    
    <p>AWS Cloud9 provides an online development environment that includes Node.js, the AWS SAM CLI, and Docker. With
      AWS Cloud9, you can start developing quickly and access your development environment from any computer. For
      instructions, see <a href="https://docs.aws.amazon.com/cloud9/latest/user-guide/get-started.html">Getting started</a> in the
        <em>AWS Cloud9 User Guide</em>.</p>
    
    <p>For local development, AWS toolkits for integrated development environments (IDEs) let you test and debug
      functions before pushing them to your repository.</p>
    <div class="itemizedlist">
       
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p><a href="https://docs.aws.amazon.com/toolkit-for-jetbrains/latest/userguide/">AWS Toolkit for JetBrains</a> – Plugin for PyCharm (Python) and IntelliJ
          (Java) IDEs.</p>
      </li><li class="listitem">
        <p><a href="https://docs.aws.amazon.com/AWSToolkitEclipse/latest/GettingStartedGuide/">AWS Toolkit for Eclipse</a> – Plugin for Eclipse IDE (multiple languages).</p>
      </li><li class="listitem">
        <p><a href="https://docs.aws.amazon.com/toolkit-for-vscode/latest/userguide/">AWS Toolkit for Visual Studio Code</a> – Plugin for Visual Studio Code IDE
          (multiple languages).</p>
      </li><li class="listitem">
        <p><a href="https://docs.aws.amazon.com/AWSToolkitVS/latest/UserGuide/">AWS Toolkit for Visual Studio</a> – Plugin for Visual Studio IDE (multiple
          languages).</p>
      </li></ul></div>
   
    <h2 id="applications-tutorial-troubleshooting">Troubleshooting</h2>
    
    <p>As you develop your application, you will likely encounter the following types of errors.</p>
    <div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p><b>Build errors</b> – Issues that occur during the build phase, including
          compilation, test, and packaging errors.</p>
      </li><li class="listitem">
        <p><b>Deployment errors</b> – Issues that occur when AWS CloudFormation isn't able to
          update the application stack. These include permissions errors, account quotas, service issues, or template
          errors.</p>
      </li><li class="listitem">
        <p><b>Invocation errors</b> – Errors that are returned by a function's code
          or runtime.</p>
      </li></ul></div>
    
    <p>For build and deployment errors, you can identify the cause of an error in the Lambda console.</p>
    <div class="procedure"><h6>To troubleshoot application errors</h6><ol><li><p>Open the Lambda console <a href="https://console.aws.amazon.com/lambda/home#/applications" rel="noopener noreferrer" target="_blank"><span>Applications page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
        <p>Choose an application.</p>
      </li><li>
        <p>Choose <b>Deployments</b>.</p>
      </li><li>
        <p>To view the application's pipeline, choose <b>Deployment pipeline</b>.</p>
      </li><li>
        <p>Identify the action that encountered an error.</p>
      </li><li>
        <p>To view the error in context, choose <b>Details</b>.</p>
      </li></ol></div>
    
    <p>For deployment errors that occur during the <b>ExecuteChangeSet</b> action, the pipeline links
      to a list of stack events in the AWS CloudFormation console. Search for an event with the status
        <b>UPDATE_FAILED</b>. Because AWS CloudFormation rolls back after an error, the relevant event is under several
      other events in the list. If AWS CloudFormation could not create a change set, the error appears under <b>Change
        sets</b> instead of under <b>Events</b>.</p>
    
    <p>A common cause of deployment and invocation errors is a lack of permissions in one or more roles. The pipeline
      has a role for deployments (<code class="code">CloudFormationRole</code>) that's equivalent to the <a href="./access-control-identity-based.html">user permissions</a> that you would use to update an AWS CloudFormation stack
      directly. If you add resources to your application or enable Lambda features that require user permissions, the
      deployment role is used. You can find a link to the deployment role under <b>Infrastructure</b> in
      the application overview.</p>
    
    <p>If your function accesses other AWS services or resources, or if you enable features that require the function
      to have additional permissions, the function's <a href="./lambda-intro-execution-role.html">execution role</a>
      is used. All execution roles that are created in your application template are also subject to the application's
      permissions boundary. This boundary requires you to explicitly grant access to additional services and resources
      in IAM after adding permissions to the execution role in the template.</p>
    
    <p>For example, to <a href="./configuration-vpc.html">connect a function to a virtual private cloud</a> (VPC),
      you need user permissions to describe VPC resources. The execution role needs permission to manage network
      interfaces. This requires the following steps.</p>
    <div class="orderedlist">
       
       
       
       
    <ol><li>
        <p>Add the required user permissions to the deployment role in IAM.</p>
      </li><li>
        <p>Add the execution role permissions to the permissions boundary in IAM.</p>
      </li><li>
        <p>Add the execution role permissions to the execution role in the application template.</p>
      </li><li>
        <p>Commit and push to deploy the updated execution role.</p>
      </li></ol></div>
    
    <p>After you address permissions errors, choose <b>Release change</b> in the pipeline overview to
      rerun the build and deployment.</p>
   
    <h2 id="applications-tutorial-cleanup">Clean up</h2>
    
    <p>You can continue to modify and use the sample to develop your own application. If you are done using the
      sample, delete the application to avoid paying for the pipeline, repository, and storage.</p>
    <div class="procedure"><h6>To delete the application</h6><ol><li>
        <p>Open the <a href="https://console.aws.amazon.com/cloudformation" rel="noopener noreferrer" target="_blank"><span>AWS CloudFormation console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
      </li><li>
        <p>Delete the application stack – <b>my-app</b>.</p>
      </li><li>
        <p>Open the <a href="https://console.aws.amazon.com/s3" rel="noopener noreferrer" target="_blank"><span>Amazon S3 console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
      </li><li>
        <p>Delete the artifact bucket – <b><code class="replaceable">us-east-2</code>-<code class="replaceable">123456789012</code>-my-app-pipe</b>.</p>
      </li><li>
        <p>Return to the AWS CloudFormation console and delete the infrastructure stack – <b>serverlessrepo-my-app-toolchain</b>.</p>
      </li></ol></div>
    
    <p>Function logs are not associated with the application or infrastructure stack in AWS CloudFormation. Delete the log group
      separately in the CloudWatch Logs console.</p>
    <div class="procedure"><h6>To delete the log group</h6><ol><li>
        <p>Open the <a href="https://console.aws.amazon.com/cloudwatch/home#logs:" rel="noopener noreferrer" target="_blank"><span>Log groups page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> of the Amazon CloudWatch
          console.</p>
      </li><li>
        <p>Choose the function's log group
              (<code class="code">/aws/lambda/my-app-helloFromLambdaFunction-<code class="replaceable">YV1VXMPLK7QK</code></code>).</p>
      </li><li>
        <p>Choose <b>Actions</b>, and then choose <b>Delete log group</b>.</p>
      </li><li>
        <p>Choose <b>Yes, Delete</b>.</p>
      </li></ol></div>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./applications-console.html">Manage applications</div><div id="next" class="next-link" accesskey="n" href="./lambda-rolling-deployments.html">Rolling deployments</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/applications-tutorial.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/applications-tutorial.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>