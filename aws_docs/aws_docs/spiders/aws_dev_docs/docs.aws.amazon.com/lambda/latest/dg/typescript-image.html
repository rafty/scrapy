<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Deploy transpiled TypeScript code in Lambda with container images - AWS Lambda</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="typescript-image" /><meta name="default_state" content="typescript-image" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/typescript-image.html" /><meta name="description" content="Deploy your TypeScript code in Lambda as a container image using an AWS provided base image." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Lambda" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="" /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/typescript-image.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lambda/latest/dg/typescript-image.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lambda/latest/dg/typescript-image.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lambda/latest/dg/typescript-image.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lambda/latest/dg/typescript-image.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/typescript-image.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/typescript-image.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lambda/latest/dg/typescript-image.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lambda/latest/dg/typescript-image.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lambda/latest/dg/typescript-image.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lambda/latest/dg/typescript-image.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lambda/latest/dg/typescript-image.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lambda/latest/dg/typescript-image.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/typescript-image.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/typescript-image.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/typescript-image.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/typescript-image.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lambda/latest/dg/typescript-image.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lambda/latest/dg/typescript-image.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/lambda/latest/dg/typescript-image.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/typescript-image.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/typescript-image.html" hreflang="x-default" /><meta name="feedback-item" content="Lambda" /><meta name="this_doc_product" content="AWS Lambda" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'lambda'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Deploy transpiled TypeScript code in Lambda with container images" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Deploy transpiled TypeScript code in Lambda with container images - AWS Lambda</title><meta name="pdf" content="/pdfs/lambda/latest/dg/lambda-dg.pdf#typescript-image" /><meta name="rss" content="lambda-updates.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=186" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/typescript-image.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/typescript-image.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/typescript-image.html" /><meta name="keywords" content="Lambda,AWS Lambda,serverless,serverless applications,cloud computing,TypeScript function,TypeScript Lambda,TypeScript define function,TypeScript Lambda function" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Lambda",
        "item" : "https://docs.aws.amazon.com/lambda/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Building Lambda functions with TypeScript",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/lambda-typescript.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Deploy transpiled TypeScript code in Lambda with container images",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/lambda-typescript.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/lambda/latest/dg/lambda-dg.pdf#typescript-image" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/lambda/index.html">AWS Lambda</a><a href="welcome.html">Developer Guide</a></div><div id="page-toc-src"><a href="#base-image-typescript">Using a Node.js base image to build and package TypeScript function code</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="typescript-image">Deploy transpiled TypeScript code in Lambda with container images</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>You can deploy your TypeScript code to an AWS Lambda function as a Node.js <a href="./images-create.html">container image</a>. AWS provides <a href="./nodejs-image.html#nodejs-image-base">base images</a> for Node.js to help you build the container image. These base images are preloaded with a language runtime and other components that are required to run the image on Lambda. AWS provides a Dockerfile for each of the base images to help with building your container image.</p><p>If you use a community or private enterprise base image, you must <a href="./nodejs-image.html#nodejs-image-clients">add the Node.js runtime interface client (RIC)</a> to the base image to make it compatible with Lambda.</p><p>Lambda provides a runtime interface emulator for local testing. The AWS base images for Node.js include the runtime interface emulator. If you use an alternative base image, such as an Alpine Linux or Debian image, you can <a href="./images-test.html#images-rie-build">build the emulator into your image</a> or <a href="./images-test.html#images-test-add">install it on your local machine</a>.</p>
    <h2 id="base-image-typescript">Using a Node.js base image to build and package TypeScript function code</h2>
    <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="Prerequisites" id="typescript-image-prerequisites" expanded="false"><p>To complete the steps in this section, you must have the following:</p><div class="itemizedlist">
           
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p><a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html">AWS Command Line Interface (AWS CLI) version 2</a></p>
          </li><li class="listitem">
            <p><a href="https://docs.docker.com/get-docker" rel="noopener noreferrer" target="_blank"><span>Docker</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
          </li><li class="listitem">
              <p>Node.js 18.x</p>
          </li></ul></div></awsui-expandable-section><awsui-expandable-section variant="container" header="Creating an image from a base image" id="typescript-image-create" expanded="false"><div class="procedure"><h6>To create an image from an AWS base image for Lambda</h6><ol><li>
        <p>On your local machine, create a project directory for your new function.</p>
      </li><li>
        <p>Create a new Node.js project with <code class="code">npm</code> or a package manager of your choice.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">npm init</code></pre>
      </li><li>
        <p>Add the <a href="https://www.npmjs.com/package/@types/aws-lambda" rel="noopener noreferrer" target="_blank"><span>@types/aws-lambda</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> and <a href="https://esbuild.github.io/" rel="noopener noreferrer" target="_blank"><span>esbuild</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> packages as development dependencies. The <code class="code">@types/aws-lambda</code> package contains the type definitions for Lambda.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">npm install -D @types/aws-lambda esbuild</code></pre>
      </li><li>
        <p>Add a <a href="https://esbuild.github.io/getting-started/#build-scripts" rel="noopener noreferrer" target="_blank"><span>build script</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> to the <code>package.json</code> file.</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">  "scripts": <span>{</span>
  "build": "esbuild index.ts --bundle --minify --sourcemap --platform=node --target=es2020 --outfile=dist/index.js"
}</code></pre>
      </li><li>
        <p>Create a new file called <code>index.ts</code>. Add the following sample code to the new file. This is the code for the Lambda function. The function returns a <code class="code">hello world</code> message.</p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The <code class="code">import</code> statement imports the type definitions from <a href="https://www.npmjs.com/package/@types/aws-lambda" rel="noopener noreferrer" target="_blank"><span>@types/aws-lambda</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. It does not import the <code class="code">aws-lambda</code> NPM package, which is an unrelated third-party tool. For more information, see <a href="https://github.com/DefinitelyTyped/DefinitelyTyped/tree/master/types/aws-lambda" rel="noopener noreferrer" target="_blank"><span>aws-lambda</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> in the DefinitelyTyped GitHub repository.</p></div></div>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">import <span>{</span> Context, APIGatewayProxyResult, APIGatewayEvent } from 'aws-lambda';

export const handler = async (event: APIGatewayEvent, context: Context): Promise&lt;APIGatewayProxyResult&gt; =&gt; <span>{</span>
    console.log(`Event: $<span>{</span>JSON.stringify(event, null, 2)}`);
    console.log(`Context: $<span>{</span>JSON.stringify(context, null, 2)}`);
    return <span>{</span>
        statusCode: 200,
        body: JSON.stringify(<span>{</span>
            message: 'hello world',
        }),
    };
};</code></pre>
      </li><li>
        <p>Create a new Dockerfile with the following configuration:</p>
        <div class="itemizedlist">
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p>Set the <code class="code">FROM</code> property to the URI of the base image.</p>
          </li><li class="listitem">
            <p>Set the <code class="code">CMD</code> argument to specify the Lambda function handler.</p>
          </li></ul></div>
        <div class="example"><h6>Example  Dockerfile</h6><div class="example-contents"><p>The following Dockerfile uses a multi-stage build. The first step transpiles the TypeScript code into JavaScript. The second step produces a container image that contains only JavaScript files and production dependencies.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="dockerfile ">FROM public.ecr.aws/lambda/nodejs:18 as builder
WORKDIR /usr/app
COPY package.json index.ts  ./
RUN npm install
RUN npm run build
    
FROM public.ecr.aws/lambda/nodejs:18
WORKDIR $<span>{</span>LAMBDA_TASK_ROOT}
COPY --from=builder /usr/app/dist/* ./
CMD ["index.handler"]</code></pre></div></div>
      </li><li>
        <p>Build the Docker image with the <a href="https://docs.docker.com/engine/reference/commandline/build/" rel="noopener noreferrer" target="_blank"><span>docker build</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> command. The
          following example names the image <code class="code">docker-image</code> and gives it the <code class="code">test</code> <a href="https://docs.docker.com/engine/reference/commandline/build/#tag" rel="noopener noreferrer" target="_blank"><span>tag</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">docker build --platform linux/amd64 -t <code class="replaceable">docker-image</code>:<code class="replaceable">test</code> .</code></pre>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The command specifies the <code class="code">--platform linux/amd64</code> option to ensure that your container is compatible with the Lambda execution environment regardless of the  
       architecture of your build machine. If you intend to create a Lambda function using the ARM64 instruction set architecture, be sure to change the command to use the <code class="code">--platform linux/arm64</code> 
       option instead.</p></div></div>
      </li></ol></div></awsui-expandable-section><awsui-expandable-section variant="container" header="(Optional) Test the image locally" id="typescript-image-test" expanded="false"><div class="procedure"><ol><li>
          <p>Start the Docker image with the <b>docker run</b> command. In this example,
              <code class="code">docker-image</code> is the image name and <code class="code">test</code> is the tag.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">docker run -p 9000:8080 <code class="replaceable">docker-image</code>:<code class="replaceable">test</code></code></pre>
          <p>This command runs the image as a container and creates a local endpoint at
            <code class="code">localhost:9000/2015-03-31/functions/function/invocations</code>.</p>
        </li><li>
          <p>From a new terminal window, post an event to the following endpoint using a <b>curl</b>
            command:</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">curl "http://localhost:9000/2015-03-31/functions/function/invocations" -d '<span>{</span>}'</code></pre>
          <p>This command invokes the function with an empty event and returns a response. If you're using your own function code rather than the sample function code, you might want to invoke the function with a JSON payload. Example:</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">curl "http://localhost:9000/2015-03-31/functions/function/invocations" -d '<code class="replaceable"><span>{</span>"payload":"hello world!"}</code>'</code></pre>
        </li><li>
          <p>Get the container ID.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">docker ps</code></pre>
        </li><li>
          <p>Use the <a href="https://docs.docker.com/engine/reference/commandline/kill/" rel="noopener noreferrer" target="_blank"><span>docker kill</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> command to stop the container. In this command, replace <code class="code">3766c4ab331c</code> with the container ID from the previous step.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">docker kill <code class="replaceable">3766c4ab331c</code></code></pre>
        </li></ol></div></awsui-expandable-section><awsui-expandable-section variant="container" header="Deploying the image" id="typescript-image-deploy" expanded="false"><div class="procedure"><h6>To upload the image to Amazon ECR and create the Lambda function</h6><ol><li>
          <p>Run the <a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ecr/get-login-password.html" rel="noopener noreferrer" target="_blank"><span>get-login-password</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> command to authenticate the Docker CLI to your Amazon ECR registry.</p>
        <div class="itemizedlist">
         
         
        <ul class="itemizedlist"><li class="listitem">
          <p>Set the <code class="code">--region</code> value to the AWS Region where you want to create the Amazon ECR repository.</p>
        </li><li class="listitem">
          <p>Replace <code class="code">111122223333</code> with your AWS account ID.</p>
        </li></ul></div>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws ecr get-login-password --region <code class="replaceable">us-east-1</code> | docker login --username AWS --password-stdin <code class="replaceable">111122223333</code>.dkr.ecr.<code class="replaceable">us-east-1</code>.amazonaws.com</code></pre>
          
        </li><li>
        <p>Create a repository in Amazon ECR using the <a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ecr/create-repository.html" rel="noopener noreferrer" target="_blank"><span>create-repository</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> command.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws ecr create-repository --repository-name <code class="replaceable">hello-world</code> --region <code class="replaceable">us-east-1</code> --image-scanning-configuration scanOnPush=true --image-tag-mutability MUTABLE</code></pre>
        
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The Amazon ECR repository must be in the same AWS Region as the Lambda function.</p></div></div>
        <p>If successful, you see a response like this:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "repository": <span>{</span>
        "repositoryArn": "arn:aws:ecr:us-east-1:111122223333:repository/hello-world",
        "registryId": "111122223333",
        "repositoryName": "hello-world",
        "repositoryUri": "111122223333.dkr.ecr.us-east-1.amazonaws.com/hello-world",
        "createdAt": "2023-03-09T10:39:01+00:00",
        "imageTagMutability": "MUTABLE",
        "imageScanningConfiguration": <span>{</span>
            "scanOnPush": true
        },
        "encryptionConfiguration": <span>{</span>
            "encryptionType": "AES256"
        }
    }
}</code></pre>
        
      </li><li>
        <p>Copy the <code class="code">repositoryUri</code> from the output in the previous step.</p>
      </li><li>
        <p>Run the <a href="https://docs.docker.com/engine/reference/commandline/tag/" rel="noopener noreferrer" target="_blank"><span>docker tag</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> command to tag your local image into your Amazon ECR repository as the latest version. In this command:</p> 
        <div class="itemizedlist">
         
         
        <ul class="itemizedlist"><li class="listitem">
          <p>Replace <code class="code">docker-image:test</code> with the name and <a href="https://docs.docker.com/engine/reference/commandline/build/#tag" rel="noopener noreferrer" target="_blank"><span>tag</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> of your Docker image.</p>
        </li><li class="listitem">
          <p>Replace <code class="code">&lt;ECRrepositoryUri&gt;</code> with the <code class="code">repositoryUri</code> that you copied. Make sure to include <code class="code">:latest</code> at the end of the URI.</p>
        </li></ul></div>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">docker tag docker-image:test &lt;ECRrepositoryUri&gt;:latest</code></pre>
      <p>Example:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">docker tag <code class="replaceable">docker-image</code>:<code class="replaceable">test</code> <code class="replaceable">111122223333</code>.dkr.ecr.<code class="replaceable">us-east-1</code>.amazonaws.com/<code class="replaceable">hello-world</code>:latest</code></pre>
      
      </li><li>
      <p>Run the <a href="https://docs.docker.com/engine/reference/commandline/push/" rel="noopener noreferrer" target="_blank"><span>docker push</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> command to deploy your local image to the Amazon ECR repository. Make sure to include <code class="code">:latest</code> at the end of the repository URI.</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">docker push <code class="replaceable">111122223333</code>.dkr.ecr.<code class="replaceable">us-east-1</code>.amazonaws.com/<code class="replaceable">hello-world</code>:latest</code></pre>

      </li><li>
      <p><a href="./gettingstarted-awscli.html#with-userapp-walkthrough-custom-events-create-iam-role">Create an execution role</a> for the function, if you don't already have one. You need the Amazon Resource Name (ARN) of the role in the next step.</p>
      </li><li>
        <p>Create the Lambda function. For <code class="code">ImageUri</code>, specify the repository URI from earlier. Make sure to include <code class="code">:latest</code> at the end of the URI.</p>
		<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws lambda create-function \
  --function-name <code class="replaceable">hello-world</code> \
  --package-type Image \
  --code ImageUri=<code class="replaceable">111122223333</code>.dkr.ecr.<code class="replaceable">us-east-1</code>.amazonaws.com/<code class="replaceable">hello-world</code>:latest \
  --role <code class="replaceable">arn:aws:iam::111122223333:role/lambda-ex</code></code></pre>
  		
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You can create a function using an image in a different AWS account, as long as the image is in the same Region as the Lambda function. For more information, see <a href="./images-create.html#configuration-images-xaccount-permissions"> Amazon ECR cross-account permissions</a>.</p></div></div>  
      </li><li>
      <p>Invoke the function.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws lambda invoke --function-name <code class="replaceable">hello-world</code> response.json</code></pre>
      <p>You should see a response like this:</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
  "ExecutedVersion": "$LATEST", 
  "StatusCode": 200
}</code></pre>
    </li><li>
    <p>To see the output of the function, check the <code>response.json</code> file.</p>
    </li></ol></div><p>To update the function code, you must build the image again, upload the new image to the Amazon ECR repository, and then use the <a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/lambda/update-function-code.html" rel="noopener noreferrer" target="_blank"><span>update-function-code</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> command to deploy the image to the Lambda function.</p></awsui-expandable-section></div>
<awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./typescript-package.html">Deploy .zip file archives</div><div id="next" class="next-link" accesskey="n" href="./typescript-context.html">Context</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/typescript-image.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/typescript-image.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>