<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Lambda Logs API - AWS Lambda</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="runtimes-logs-api" /><meta name="default_state" content="runtimes-logs-api" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/runtimes-logs-api.html" /><meta name="description" content="Lambda extensions can use the Logs API to subscribe to function logs and platform logs." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Lambda" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="" /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/runtimes-logs-api.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lambda/latest/dg/runtimes-logs-api.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lambda/latest/dg/runtimes-logs-api.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lambda/latest/dg/runtimes-logs-api.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lambda/latest/dg/runtimes-logs-api.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/runtimes-logs-api.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/runtimes-logs-api.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lambda/latest/dg/runtimes-logs-api.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lambda/latest/dg/runtimes-logs-api.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lambda/latest/dg/runtimes-logs-api.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lambda/latest/dg/runtimes-logs-api.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lambda/latest/dg/runtimes-logs-api.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lambda/latest/dg/runtimes-logs-api.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/runtimes-logs-api.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/runtimes-logs-api.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/runtimes-logs-api.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/runtimes-logs-api.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lambda/latest/dg/runtimes-logs-api.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lambda/latest/dg/runtimes-logs-api.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/lambda/latest/dg/runtimes-logs-api.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/runtimes-logs-api.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/runtimes-logs-api.html" hreflang="x-default" /><meta name="feedback-item" content="Lambda" /><meta name="this_doc_product" content="AWS Lambda" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'lambda'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Lambda Logs API" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Lambda Logs API - AWS Lambda</title><meta name="pdf" content="/pdfs/lambda/latest/dg/lambda-dg.pdf#runtimes-logs-api" /><meta name="rss" content="lambda-updates.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=186" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/runtimes-logs-api.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/runtimes-logs-api.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/runtimes-logs-api.html" /><meta name="keywords" content="Lambda,AWS Lambda,serverless,serverless applications,cloud computing,Lambda extensions,Lambda function monitoring,Lambda extensions partners,Lambda external extensions,Lambda internal extensions,Telemetry API,Lambda telemetry API,Lambda extensions telemetry,Lambda runtime telemetry,Lambda telemetry subscribe,logs,runtime,extensions,subscribe,platform.runtimeDone" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Lambda",
        "item" : "https://docs.aws.amazon.com/lambda/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Lambda extensions",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/lambda-extensions.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Lambda Telemetry API",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/telemetry-api.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Lambda Logs API",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/telemetry-api.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/lambda/latest/dg/lambda-dg.pdf#runtimes-logs-api" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/lambda/index.html">AWS Lambda</a><a href="welcome.html">Developer Guide</a></div><div id="page-toc-src"><a href="#runtimes-logs-api-subscribing">Subscribing to receive logs</a><a href="#runtimes-logs-api-memory">Memory usage</a><a href="#runtimes-logs-api-dest">Destination protocols</a><a href="#runtimes-logs-api-buffering">Buffering configuration</a><a href="#runtimes-logs-api-subs-example">Example subscription</a><a href="#runtimes-logs-api-samples">Sample code for Logs API</a><a href="#runtimes-logs-api-ref">Logs API reference</a><a href="#runtimes-logs-api-msg">Log messages</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="runtimes-logs-api">Lambda Logs API</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>The Lambda Telemetry API supersedes the Lambda Logs API. <b>While the Logs API
    remains fully functional, we recommend using only the Telemetry API going forward.</b> You can subscribe
    your extension to a telemetry stream using either the Telemetry API or the Logs API. After subscribing using one
    of these APIs, any attempt to subscribe using the other API returns an error.</p></div></div><p>Lambda automatically captures runtime logs and streams them to Amazon CloudWatch. This log stream contains the logs that
    your function code and extensions generate, and also the logs that Lambda generates as part of the function
    invocation.</p><p><a href="./runtimes-extensions-api.html">Lambda extensions</a> can use the Lambda Runtime Logs API to subscribe
    to log streams directly from within the Lambda <a href="./lambda-runtime-environment.html">execution environment</a>. Lambda
    streams the logs to the extension, and the extension can then process, filter, and send the logs to any preferred
    destination.</p><div class="mediaobject">
     
      <img src="/images/lambda/latest/dg/images/logs-api-concept-diagram.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;      The Extensions API and the Logs API connect Lambda and external extensions.&#xA;    " style="max-width:100%" />
     
     
  </div><p>The Logs API allows extensions to subscribe to three different logs streams:</p><div class="itemizedlist">
     
     
     
  <ul class="itemizedlist"><li class="listitem"><p>Function logs that the Lambda function generates and writes to <code class="code">stdout</code> or <code class="code">stderr</code>.</p></li><li class="listitem"><p>Extension logs that extension code generates.</p></li><li class="listitem"><p>Lambda platform logs, which record events and errors related to invocations and extensions.</p></li></ul></div><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Lambda sends all logs to CloudWatch, even when an extension subscribes to one or more of the log streams.</p></div></div><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#runtimes-logs-api-subscribing">Subscribing to receive logs</a></li><li><a href="#runtimes-logs-api-memory">Memory usage</a></li><li><a href="#runtimes-logs-api-dest">Destination protocols</a></li><li><a href="#runtimes-logs-api-buffering">Buffering configuration</a></li><li><a href="#runtimes-logs-api-subs-example">Example subscription</a></li><li><a href="#runtimes-logs-api-samples">Sample code for Logs API</a></li><li><a href="#runtimes-logs-api-ref">Logs API reference</a></li><li><a href="#runtimes-logs-api-msg">Log messages</a></li></ul></div>
    <h2 id="runtimes-logs-api-subscribing">Subscribing to receive logs</h2>
    <p>A Lambda extension can subscribe to receive logs by sending a subscription request to the Logs API.</p>
    <p>To subscribe to receive logs, you need the extension identifier (<code class="code">Lambda-Extension-Identifier</code>).
      First <a href="./runtimes-extensions-api.html#extensions-registration-api-a">register the extension</a> to receive the extension
      identifier. Then subscribe to the Logs API during <a href="./lambda-runtime-environment.html#runtimes-lifecycle-ib">initialization</a>.
      After the initialization phase completes, Lambda does not process subscription requests.</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Logs API subscription is idempotent. Duplicate subscribe requests do not result in duplicate
        subscriptions.</p></div></div>
   
    <h2 id="runtimes-logs-api-memory">Memory usage</h2>
    <p>Memory usage increases linearly as the number of subscribers increases. Subscriptions consume memory resources
      because each subscription opens a new memory buffer to store the logs. To help optimize memory usage, you can
      adjust the <a href="#runtimes-logs-api-buffering">buffering configuration</a>. Buffer memory usage counts
      towards overall memory consumption in the execution environment.</p>
   
    <h2 id="runtimes-logs-api-dest">Destination protocols</h2>
    <p>You can choose one of the following protocols to receive the logs:</p>
    <div class="orderedlist">
       
       
    <ol><li>
        <p><b>HTTP</b> (recommended) – Lambda delivers logs to a local HTTP endpoint
            (<code class="code">http://sandbox.localdomain:$<span>{</span>PORT}/$<span>{</span>PATH}</code>) as an array of records in JSON format. The
            <code class="code">$PATH</code> parameter is optional. Note that only HTTP is supported, not HTTPS. You can choose to
          receive logs through PUT or POST.</p>
      </li><li>
        <p><b>TCP</b> – Lambda delivers logs to a TCP port in <a href="https://github.com/ndjson/ndjson-spec" rel="noopener noreferrer" target="_blank"><span>Newline delimited JSON (NDJSON) format</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
      </li></ol></div>
    <p>We recommend using HTTP rather than TCP. With TCP, the Lambda platform cannot acknowledge when it delivers logs
      to the application layer. Therefore, you might lose logs if your extension crashes. HTTP does not share this
      limitation.</p>
    <p>We also recommend setting up the local HTTP listener or the TCP port before subscribing to receive logs.
      During setup, note the following:</p>
    <div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>Lambda sends logs only to destinations that are inside the execution environment.</p>
      </li><li class="listitem">
        <p>Lambda retries the attempt to send the logs (with backoff) if there is no listener, or if the POST or PUT
          request results in an error. If the log subscriber crashes, it continues to receive logs after Lambda restarts
          the execution environment.</p>
      </li><li class="listitem">
        <p>Lambda reserves port 9001. There are no other port number restrictions or recommendations.</p>
      </li></ul></div>
   
    <h2 id="runtimes-logs-api-buffering">Buffering configuration</h2>
    <p>Lambda can buffer logs and deliver them to the subscriber. You can configure this behavior in the subscription
      request by specifying the following optional fields. Note that Lambda uses the default value for any field that you
      do not specify.</p>
    <div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem"><p><b>timeoutMs</b> – The maximum time (in milliseconds) to buffer a batch. Default:
          1,000. Minimum: 25. Maximum: 30,000.</p></li><li class="listitem"><p><b>maxBytes</b> – The maximum size (in bytes) of the logs to buffer in memory.
          Default: 262,144. Minimum: 262,144. Maximum: 1,048,576.</p></li><li class="listitem"><p><b>maxItems</b> – The maximum number of events to buffer in memory. Default:
          10,000. Minimum: 1,000. Maximum: 10,000.</p></li></ul></div>
    <p>During buffering configuration, note the following points:</p>
    <div class="itemizedlist">
       
       
       
       
    <ul class="itemizedlist"><li class="listitem"><p>Lambda flushes the logs if any of the input streams are closed, for example, if the runtime crashes.</p></li><li class="listitem"><p>Each subscriber can specify a different buffering configuration in their subscription request.</p></li><li class="listitem"><p>Consider the buffer size that you need for reading the data. Expect to receive payloads as large as
            <code class="code">2*maxBytes+metadata</code>, where <code class="code">maxBytes</code> is configured in the subscribe request. For
          example, Lambda adds the following metadata bytes to each record:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
"time": "2020-08-20T12:31:32.123Z",
"type": "function",
"record": "Hello World"
}           </code></pre></li><li class="listitem"><p>If the subscriber cannot process incoming logs quickly enough, Lambda might drop logs to keep memory utilization
          bounded. To indicate the number of dropped records, Lambda sends a <code class="code">platform.logsDropped</code>
          log.</p></li></ul></div>
   
    <h2 id="runtimes-logs-api-subs-example">Example subscription</h2>
    <p>The following example shows a request to subscribe to the platform and function logs.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">PUT http://$<span>{</span>AWS_LAMBDA_RUNTIME_API}/2020-08-15/logs HTTP/1.1
<span>{</span> "schemaVersion": "2020-08-15",
  "types": [
      "platform",
      "function"
    ],
  "buffering": <span>{</span>
      "maxItems": 1000,
      "maxBytes": 262144,
      "timeoutMs": 100
    },
  "destination": <span>{</span>
    "protocol": "HTTP",
    "URI": "http://sandbox.localdomain:8080/lambda_logs"
  }
}    </code></pre>
    <p>If the request succeeds, the subscriber receives an HTTP 200 success response.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">HTTP/1.1 200 OK
"OK"      </code></pre>
   
    <h2 id="runtimes-logs-api-samples">Sample code for Logs API</h2>
    <p>For sample code showing how to send logs to a custom destination, see <a href="http://aws.amazon.com/blogs/compute/using-aws-lambda-extensions-to-send-logs-to-custom-destinations/" rel="noopener noreferrer" target="_blank"><span>Using AWS Lambda extensions to
        send logs to custom destinations</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> on the AWS Compute Blog.</p>
    <p>For Python and Go code examples showing how to develop a basic Lambda extension and subscribe to the Logs API,
      see <a href="https://github.com/aws-samples/aws-lambda-extensions" rel="noopener noreferrer" target="_blank"><span>AWS Lambda Extensions</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> on the AWS
      Samples GitHub repository. For more information about building a Lambda extension, see <a href="./runtimes-extensions-api.html">Lambda Extensions API</a>.</p>
   
    <h2 id="runtimes-logs-api-ref">Logs API reference</h2>
    <p>You can retrieve the Logs API endpoint from the <code class="code">AWS_LAMBDA_RUNTIME_API</code> environment variable. To
      send an API request, use the prefix <code class="code">2020-08-15/</code> before the API path. For example:</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">http://$<span>{</span>AWS_LAMBDA_RUNTIME_API}/2020-08-15/logs</code></pre>
    <p>The OpenAPI specification for the Logs API version <b>2020-08-15</b> is available
      here: <a href="samples/logs-api-request.zip" rel="noopener noreferrer" target="_blank">logs-api-request.zip</a></p>
     
      <h3 id="runtimes-logs-api-ref-a">Subscribe</h3>
      <p>To subscribe to one or more of the log streams available in the Lambda execution environment, extensions send
        a Subscribe API request.</p>
      <p><b>Path</b> – <code class="code">/logs</code></p>
      <p><b>Method</b> – <b>PUT</b></p>
      <p><b>Body parameters</b></p>
      <p><code class="code">destination</code> – See <a href="#runtimes-logs-api-dest">Destination protocols</a>. Required: yes. Type:
        strings.</p>
      <p><code class="code">buffering</code> – See <a href="#runtimes-logs-api-buffering">Buffering configuration</a>. Required: no. Type:
        strings.</p>
      <p><code class="code">types</code> – An array of the types of logs to receive. Required: yes. Type: array of strings.
        Valid values: "platform", "function", "extension".</p>
      <p><code class="code">schemaVersion</code> – Required: no. Default value: "2020-08-15". Set to "2021-03-18" for the
        extension to receive <a href="#runtimes-logs-api-ref-done">platform.runtimeDone</a>
        messages.</p>
      <div class="itemizedlist">
        <h6><b>Response parameters</b></h6>
        <p>The OpenAPI specifications for the subscription responses version <b>2020-08-15</b> are available for the HTTP and TCP protocols:</p>
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p>HTTP: <a href="samples/logs-api-http-response.zip" rel="noopener noreferrer" target="_blank">logs-api-http-response.zip</a></p>
        </li><li class="listitem">
          <p>TCP: <a href="samples/logs-api-tcp-response.zip" rel="noopener noreferrer" target="_blank">logs-api-tcp-response.zip</a></p>
        </li></ul></div>
      <div class="itemizedlist">
        <h6><b>Response codes</b></h6>
         
         
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p>200 – Request completed successfully</p>
        </li><li class="listitem">
          <p>202 – Request accepted. Response to a subscription request during local testing.</p>
        </li><li class="listitem">
          <p>4XX – Bad Request</p>
        </li><li class="listitem">
          <p>500 – Service error</p>
        </li></ul></div>
      <p>If the request succeeds, the subscriber receives an HTTP 200 success response.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">HTTP/1.1 200 OK
"OK"      </code></pre>
      <p>If the request fails, the subscriber receives an error response. For example:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">HTTP/1.1 400 OK
<span>{</span>
    "errorType": "Logs.ValidationError",
    "errorMessage": URI port is not provided; types should not be empty"
}   </code></pre>
     

   
    <h2 id="runtimes-logs-api-msg">Log messages</h2>
    <p>The Logs API allows extensions to subscribe to three different logs streams:</p>
    <div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem"><p>Function – Logs that the Lambda function generates and writes to <code class="code">stdout</code> or
          <code class="code">stderr</code>.</p></li><li class="listitem"><p>Extension – Logs that extension code generates.</p></li><li class="listitem"><p>Platform – Logs that the runtime platform generates, which record events and errors related to invocations
          and extensions.</p></li></ul></div>
    <div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#runtimes-logs-api-msg-function">Function logs</a></li><li><a href="#runtimes-logs-api-msg-extension">Extension logs</a></li><li><a href="#runtimes-logs-api-msg-platform">Platform logs</a></li></ul></div>
     
      <h3 id="runtimes-logs-api-msg-function">Function logs</h3>
      <p>The Lambda function and internal extensions generate function logs and write them to <code class="code">stdout</code> or
          <code class="code">stderr</code>.</p>
      <p>The following example shows the format of a function log message. <span>{</span>     "time": "2020-08-20T12:31:32.123Z",
        "type": "function",     "record": "ERROR encountered. Stack trace:\n\my-function (line 10)\n" }  </p>
     
     
      <h3 id="runtimes-logs-api-msg-extension">Extension logs</h3>
      <p>Extensions can generate extension logs. The log format is the same as for a function log.</p>
     
     
      <h3 id="runtimes-logs-api-msg-platform">Platform logs</h3>
      <p>Lambda generates log messages for platform events such as <code class="code">platform.start</code>,
          <code class="code">platform.end</code>, and <code class="code">platform.fault</code>.</p>
      <p>Optionally, you can subscribe to the <b>2021-03-18</b> version of the Logs API
        schema, which includes the <code class="code">platform.runtimeDone</code> log message.</p>

       
        <h4 id="runtimes-logs-api-examples">Example platform log messages</h4>
        <p>The following example shows the platform start and platform end logs. These logs indicate the invocation
          start time and invocation end time for the invocation that the requestId specifies.  </p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>     
    "time": "2020-08-20T12:31:32.123Z",
    "type": "platform.start",
    "record": <span>{</span>"requestId": "6f7f0961f83442118a7af6fe80b88d56"}   
}
<span>{</span>
    "time": "2020-08-20T12:31:32.123Z",
    "type": "platform.end",
    "record": <span>{</span>"requestId": "6f7f0961f83442118a7af6fe80b88d56"}   
}</code></pre>
<p>The <b>platform.initRuntimeDone</b> log message shows the status of the <code class="code">Runtime init</code> sub-phase, which is part of the <a href="./lambda-runtime-environment.html#runtimes-lifecycle-ib">Init lifecyle phase</a>. When <code class="code">Runtime init</code> is successful, the runtime sends a <code class="code">/next</code> runtime API request (for the <code class="code">on-demand</code> and <code class="code">provisioned-concurrency</code> initialization types) or <code class="code">restore/next</code> (for the <code class="code">snap-start</code> initialization type). The following example shows a successful <b>platform.initRuntimeDone</b> log message for the <code class="code">snap-start</code> initialization type.</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
  "time":"2022-07-17T18:41:57.083Z",
  "type":"platform.initRuntimeDone",
  "record":<span>{</span>
      "initializationType":"snap-start",
      "status":"success"
  }
}</code></pre>
<p>The <b>platform.initReport</b> log message shows how long the <code class="code">Init</code> phase lasted and how many milliseconds you were billed for during this phase. When the initialization type is <code class="code">provisioned-concurrency</code>, Lambda sends this message during invocation. When the initialization type is <code class="code">snap-start</code>, Lambda sends this message after restoring the snapshot. The following example shows a <b>platform.initReport</b> log message for the <code class="code">snap-start</code> initialization type.</p> 
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
  "time":"2022-07-17T18:41:57.083Z",
  "type":"platform.initReport",
  "record":<span>{</span>
      "initializationType":"snap-start",
      "metrics":<span>{</span>
          "durationMs":731.79,
          "billedDurationMs":732
          }
  }
}</code></pre>
        <p>The platform report log includes metrics about the invocation that the requestId specifies. The
            <code class="code">initDurationMs</code> field is included in the log only if the invocation included a cold start. If
          AWS X-Ray tracing is active, the log includes X-Ray metadata. The following example shows a platform report
          log for an invocation that included a cold start.</p> 
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>     
    "time": "2020-08-20T12:31:32.123Z",
    "type": "platform.report",
    "record": <span>{</span>"requestId": "6f7f0961f83442118a7af6fe80b88d56",
        "metrics": <span>{</span>"durationMs": 101.51,
            "billedDurationMs": 300,
            "memorySizeMB": 512,
            "maxMemoryUsedMB": 33,
            "initDurationMs": 116.67
        }
    }
} </code></pre>
        <p>The platform fault log captures runtime or execution environment errors. The following example shows a
          platform fault log message. </p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>     
    "time": "2020-08-20T12:31:32.123Z",
    "type": "platform.fault",
    "record": "RequestId: d783b35e-a91d-4251-af17-035953428a2c Process exited before completing request"
}</code></pre> 
        <p>Lambda generates a platform extension log when an extension registers with the extensions API. The
          following example shows a platform extension message. </p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>     
    "time": "2020-08-20T12:31:32.123Z",
    "type": "platform.extension",
    "record": <span>{</span>"name": "Foo.bar",
        "state": "Ready",
        "events": ["INVOKE", "SHUTDOWN"]
     }
}</code></pre> 
        <p>Lambda generates a platform logs subscription log when an extension subscribes to the logs API. The
          following example shows a logs subscription message. </p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>     
    "time": "2020-08-20T12:31:32.123Z",
    "type": "platform.logsSubscription",
    "record": <span>{</span>"name": "Foo.bar",
        "state": "Subscribed",
        "types": ["function", "platform"],
    }
}</code></pre> 
        <p>Lambda generates a platform logs dropped log when an extension is not able to process the number of logs
          that it is receiving. The following example shows a <code class="code">platform.logsDropped</code> log message. </p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>     
    "time": "2020-08-20T12:31:32.123Z",
    "type": "platform.logsDropped",
    "record": <span>{</span>"reason": "Consumer seems to have fallen behind as it has not acknowledged receipt of logs.",
        "droppedRecords": 123,
        "droppedBytes" 12345
    }
}</code></pre> 
<p>The <b>platform.restoreStart</b> log message shows the time that the <code class="code">Restore</code> phase started (<code class="code">snap-start</code> initialization type only). Example:</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span> 
  "time":"2022-07-17T18:43:44.782Z", 
  "type":"platform.restoreStart", 
  "record":<span>{</span>} 
}</code></pre>
<p>The <b>platform.restoreReport</b> log message shows how long the <code class="code">Restore</code> phase lasted and how many milliseconds you were billed for during this phase (<code class="code">snap-start</code> initialization type only). Example:</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
  "time":"2022-07-17T18:43:45.936Z",
  "type":"platform.restoreReport",
  "record":<span>{</span>
      "metrics":<span>{</span>
          "durationMs":70.87,
          "billedDurationMs":13
      }
  }
}</code></pre>
       
       
        <h4 id="runtimes-logs-api-ref-done">Platform <code class="code">runtimeDone</code> messages</h4>
        <p>If you set the schema version to "2021-03-18" in the subscribe request, Lambda sends a
            <code class="code">platform.runtimeDone</code> message after the function invocation completes either successfully or
          with an error. The extension can use this message to stop all the telemetry collection for this function
          invocation.</p>
        <p>The OpenAPI specification for the Log event type in schema version <b>2021-03-18</b> is available here: <a href="samples/schema-2021-03-18.zip" rel="noopener noreferrer" target="_blank">schema-2021-03-18.zip</a></p>
        <p>Lambda generates the <code class="code">platform.runtimeDone</code> log message when the runtime sends a
            <code class="code">Next</code> or <code class="code">Error</code> runtime API request. The <code class="code">platform.runtimeDone</code> log
          informs consumers of the Logs API that the function invocation completes. Extensions can use this information
          to decide when to send all the telemetry collected during that invocation.</p>

         
          <h5 id="runtimes-logs-api-examples">Examples</h5>
          <p>Lambda sends the <code class="code">platform.runtimeDone</code> message after the runtime sends the NEXT request when
            the function invocation completes. The following examples show messages for each of the status values:
            success, failure, and timeout.</p>
          <div class="example"><h6>Example success message</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "time": "2021-02-04T20:00:05.123Z",
    "type": "platform.runtimeDone",
    "record": <span>{</span>
       "requestId":"6f7f0961f83442118a7af6fe80b88",
       "status": "success"
    }
}         </code></pre></div></div>
          <div class="example"><h6>Example failure message</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
   "time": "2021-02-04T20:00:05.123Z",
   "type": "platform.runtimeDone",
   "record": <span>{</span>
      "requestId":"6f7f0961f83442118a7af6fe80b88",
      "status": "failure"
   }
}        </code></pre></div></div>
          <div class="example"><h6>Example timeout message </h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
   "time": "2021-02-04T20:00:05.123Z",
   "type": "platform.runtimeDone",
   "record": <span>{</span>
      "requestId":"6f7f0961f83442118a7af6fe80b88",
      "status": "timeout"
  }
}</code></pre></div></div>
          <div class="example"><h6>Example platform.restoreRuntimeDone message (<code class="code">snap-start</code> initialization type only)</h6><div class="example-contents"><p>The <b>platform.restoreRuntimeDone</b> log message shows whether or not the <code class="code">Restore</code> phase was successful. Lambda sends this message when the runtime sends a <code class="code">restore/next</code> runtime API request. There are three possible statuses: success, failure, and timeout. The following example shows a successful <b>platform.restoreRuntimeDone</b> log message.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
  "time":"2022-07-17T18:43:45.936Z",
  "type":"platform.restoreRuntimeDone",
  "record":<span>{</span>
      "status":"success"
  }
}</code></pre></div></div>
         

       

     

  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./telemetry-otel-spans.html">Converting events to OTel Spans</div><div id="next" class="next-link" accesskey="n" href="./lambda-troubleshooting.html">Troubleshooting</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/runtimes-logs-api.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/runtimes-logs-api.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>