<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Working with .zip file archives for Ruby Lambda functions - AWS Lambda</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="ruby-package" /><meta name="default_state" content="ruby-package" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/ruby-package.html" /><meta name="description" content="Learn how to deploy Ruby Lambda function code using a .zip file deployment package." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Lambda" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="" /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/ruby-package.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lambda/latest/dg/ruby-package.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lambda/latest/dg/ruby-package.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lambda/latest/dg/ruby-package.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lambda/latest/dg/ruby-package.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/ruby-package.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/ruby-package.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lambda/latest/dg/ruby-package.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lambda/latest/dg/ruby-package.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lambda/latest/dg/ruby-package.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lambda/latest/dg/ruby-package.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lambda/latest/dg/ruby-package.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lambda/latest/dg/ruby-package.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/ruby-package.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/ruby-package.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/ruby-package.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/ruby-package.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lambda/latest/dg/ruby-package.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lambda/latest/dg/ruby-package.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/lambda/latest/dg/ruby-package.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/ruby-package.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/ruby-package.html" hreflang="x-default" /><meta name="feedback-item" content="Lambda" /><meta name="this_doc_product" content="AWS Lambda" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'lambda'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Working with .zip file archives for Ruby Lambda functions" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Working with .zip file archives for Ruby Lambda functions - AWS Lambda</title><meta name="pdf" content="/pdfs/lambda/latest/dg/lambda-dg.pdf#ruby-package" /><meta name="rss" content="lambda-updates.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=186" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/ruby-package.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/ruby-package.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/ruby-package.html" /><meta name="keywords" content="Lambda,AWS Lambda,serverless,serverless applications,cloud computing" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Lambda",
        "item" : "https://docs.aws.amazon.com/lambda/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Building Lambda functions with Ruby",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/lambda-ruby.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Working with .zip file archives for Ruby Lambda functions",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/lambda-ruby.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/lambda/latest/dg/lambda-dg.pdf#ruby-package" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/lambda/index.html">AWS Lambda</a><a href="welcome.html">Developer Guide</a></div><div id="page-toc-src"><a href="#ruby-package-runtime-dependencies">Dependencies in Ruby</a><a href="#ruby-package-codeonly">Creating a .zip deployment package with no dependencies</a><a href="#ruby-package-dependencies">Creating a .zip deployment packaged with dependencies</a><a href="#ruby-package-dependencies-layers">Creating a Ruby layer for your dependencies</a><a href="#ruby-package-native">Creating .zip deployment packages with native libraries</a><a href="#ruby-package-create-functions">Creating and updating Ruby Lambda functions using .zip files</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="ruby-package">Working with .zip file archives for Ruby Lambda functions</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>
    Your AWS Lambda function’s code comprises a .rb file containing your function’s handler code, together with any additional dependencies (gems) 
    your code depends on. To deploy this function code to Lambda, you use a <em>deployment package</em>. This package may either be a 
  .zip file archive or a container image.  
  For more information about using container images with Ruby, see <a href="https://docs.aws.amazon.com/lambda/latest/dg/ruby-image.html">Deploy Ruby Lambda functions with container images</a>.
  </p><p>
    To create your deployment package as .zip file archive, you can use your command-line tool’s built-in .zip file archive utility, or any other 
    .zip file utility such as <a href="https://www.7-zip.org/download.html" rel="noopener noreferrer" target="_blank"><span>7zip</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. The examples shown in the following sections assume 
  you’re using a command-line <code class="code">zip</code> tool in a Linux or MacOS environment. To use the same commands in Windows, you can 
  <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" rel="noopener noreferrer" target="_blank"><span>install the Windows Subsystem for Linux</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> to get a Windows-integrated 
  version of Ubuntu and Bash.
  </p><p>
    Note that Lambda uses POSIX file permissions, so you may need to <a href="http://aws.amazon.com/premiumsupport/knowledge-center/lambda-deployment-package-errors/" rel="noopener noreferrer" target="_blank"><span>set permissions for the deployment package folder</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> before you create the .zip file archive.
  </p><p>The example commands in the following sections use the <a href="https://bundler.io/" rel="noopener noreferrer" target="_blank"><span>Bundler</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> utility to add dependencies to your 
    deployment package. To install bundler, run the following command.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">gem install bundler</code></code></pre><div class="highlights" id="inline-topiclist"><h6>Sections</h6><ul><li><a href="#ruby-package-runtime-dependencies">Dependencies in Ruby</a></li><li><a href="#ruby-package-codeonly">Creating a .zip deployment package with no dependencies</a></li><li><a href="#ruby-package-dependencies">Creating a .zip deployment packaged with dependencies</a></li><li><a href="#ruby-package-dependencies-layers">Creating a Ruby layer for your dependencies</a></li><li><a href="#ruby-package-native">Creating .zip deployment packages with native libraries</a></li><li><a href="#ruby-package-create-functions">Creating and updating Ruby Lambda functions using .zip files</a></li></ul></div>
  <h2 id="ruby-package-runtime-dependencies">Dependencies in Ruby</h2>
  <p>For Lambda functions that use the Ruby runtime, a dependency can be any Ruby gem. When you deploy your function using a .zip archive, you 
    can either add these dependencies to your .zip file with your function code or use a Lambda layer. A layer is a separate .zip file that can 
    contain additional code and other content. To learn more about using Lambda layers, see <a href="./chapter-layers.html">Working with Lambda layers</a>.</p>
  <p>Versions 2.7 and 3.2 of the Ruby runtime includes the AWS SDK for Ruby. If your function uses the SDK, you don't need to bundle it with your code. 
 However, to maintain full control of your dependencies, or to use a specific version of the SDK, you can add it to your function's deployment package. 
  You can either include the SDK in your .zip file, or add it using a Lambda layer. Dependencies in your .zip file or in Lambda layers take precedence over 
  versions included in the runtime. To see which version of the SDK for Ruby is included in your runtime version, see <a href="./lambda-runtimes.html">Lambda runtimes</a>. </p>
  <p>
    Under the <a href="https://docs.aws.amazon.com/whitepapers/latest/aws-risk-and-compliance/shared-responsibility-model.html">AWS shared responsibility model</a>, 
    you are responsible for the management of any dependencies in your functions' deployment packages. This includes applying updates and security 
    patches. To update dependencies in your function's deployment package, first create a new .zip file and then upload it to Lambda. See <a href="#ruby-package-dependencies">Creating a .zip deployment packaged with dependencies</a> 
    and <a href="#ruby-package-create-functions">Creating and updating Ruby Lambda functions using .zip files</a> for more information.
  </p>
  
 
    <h2 id="ruby-package-codeonly">Creating a .zip deployment package with no dependencies</h2>
    <p>If your function code has no dependencies, your .zip file contains only the .rb file with your function’s handler code. Use your preferred 
      zip utility to create a .zip file with your .rb file at the root. If the .rb file is not at the root of your .zip file, Lambda won’t be able to 
      run your code.</p>
    <p>To learn how to deploy your .zip file to create a new Lambda function or update an existing one, see <a href="#ruby-package-create-functions">Creating and updating Ruby Lambda functions using .zip files</a>.</p>
   
    <h2 id="ruby-package-dependencies">Creating a .zip deployment packaged with dependencies</h2>
    <p>If your function code depends on additional Ruby gems, you can either add these dependencies to your .zip file with your function code or 
      use a <a href="./chapter-layers.html">Lambda layer</a>. The instructions in this section show you how to include dependencies in your .zip deployment package.
      For instructions on how to include your dependencies in a layer, see
      <a href="#ruby-package-dependencies-layers">Creating a Ruby layer for your dependencies</a>.</p>
    <p>Suppose your function code is saved in a file named <code class="code">lambda_function.rb</code> in your project directory. The following example CLI commands create a .zip file 
      named <code class="code">my_deployment_package.zip</code> containing your function code and its dependencies.</p>
    <div class="procedure"><h6>To create the deployment package</h6><ol><li>
        <p>In your project directory, create a <code class="code">Gemfile</code> to specify your dependencies in.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">bundle init</code></code></pre>
      </li><li>
        <p>Using your preferred text editor, edit the <code class="code">Gemfile</code> to specify your function's dependencies. For example, to use the TZInfo 
        gem, edit your <code class="code">Gemfile</code> to look like the following.
        </p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">source "https://rubygems.org"
gem "tzinfo"</code></pre>
      </li><li>
        <p>Run the following command to install the gems specified in your <code class="code">Gemfile</code> in your project directory. This command sets 
          <code class="code">vendor/bundle</code> as the default path for gem installations.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">bundle config set --local path 'vendor/bundle' &amp;&amp; bundle install</code></code></pre>
        <p>You should see output similar to the following.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">Fetching gem metadata from https://rubygems.org/...........
Resolving dependencies...
Using bundler 2.4.13
Fetching tzinfo 2.0.6
Installing tzinfo 2.0.6
...</code></pre>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>To install gems globally again later, run the following command.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">bundle config set --local system 'true'</code></code></pre></div></div>
      </li><li>
        <p>Create a .zip file archive containing the <code class="code">lambda_function.rb</code> file with your function's handler code and the dependencies 
          you installed in the previous step.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">zip -r my_deployment_package.zip lambda_function.rb vendor</code></code></pre>
        <p>You should see output similar to the following.</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">adding: lambda_function.rb (deflated 37%)
  adding: vendor/ (stored 0%)
  adding: vendor/bundle/ (stored 0%)
  adding: vendor/bundle/ruby/ (stored 0%)
  adding: vendor/bundle/ruby/3.2.0/ (stored 0%)
  adding: vendor/bundle/ruby/3.2.0/build_info/ (stored 0%)
  adding: vendor/bundle/ruby/3.2.0/cache/ (stored 0%)
  adding: vendor/bundle/ruby/3.2.0/cache/aws-eventstream-1.0.1.gem (deflated 36%)
...</code></pre>
      </li></ol></div>
   
    <h2 id="ruby-package-dependencies-layers">Creating a Ruby layer for your dependencies</h2>
    <p>The instructions in this section show you how to include your dependencies in a layer. For instructions
      on how to include your dependencies in your deployment package, see
      <a href="#ruby-package-dependencies">Creating a .zip deployment packaged with dependencies</a>.</p>
    <p>When you add a layer to a function, Lambda loads the layer content into the
      <code class="code">/opt</code> directory of that execution environment. For each Lambda runtime,
      the <code class="code">PATH</code> variable already includes specific folder paths within the
      <code class="code">/opt</code> directory. To ensure that your layer content gets picked up by
      the <code class="code">PATH</code> variable, include the content in the following folder paths:</p>
    <div class="itemizedlist">
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p><code class="code">ruby/gems/2.7.0</code> (<code class="code">GEM_PATH</code>)</p>
      </li><li class="listitem">
        <p><code class="code">ruby/lib</code> (<code class="code">RUBYLIB</code>)</p>
      </li></ul></div>
    <p>For example, your layer .zip file structure might look like the following:</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">json.zip
└ ruby/gems/2.7.0/
               | build_info
               | cache
               | doc
               | extensions
               | gems
               | └ json-2.1.0
               └ specifications
                 └ json-2.1.0.gemspec</code></pre>
    <p>In addition, Lambda automatically detects any libraries in the <code class="code">/opt/lib</code>
      directory, and any binaries in the <code class="code">/opt/bin</code> directory. To ensure
      that Lambda properly finds your layer content, you can also create a layer
      with the following structure:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">custom-layer.zip
└ lib
    | lib_1
    | lib_2
└ bin
    | bin_1
    | bin_2</code></pre>
    <p>After you package your layer, see <a href="./creating-deleting-layers.html">Creating and deleting layers in Lambda</a>
      and <a href="./adding-layers.html">Adding layers to functions</a> to complete your layer setup.</p>
   
    <h2 id="ruby-package-native">Creating .zip deployment packages with native libraries</h2>
      <p>Many common Ruby gems such as <code class="code">nokogiri</code>, <code class="code">nio4r</code>, and <code class="code">mysql</code> contain native extensions written in 
        C. When you add libraries containing C code to your deployment package, you must build your package correctly to ensure that 
        it’s compatible with the Lambda execution environment. 
      </p>
      <p>For production applications, we recommend building and deploying your code using the AWS Serverless Application Model (AWS SAM). In AWS SAM use the <code class="code">sam build --use-container</code> 
        option to build your function inside a Lambda-like Docker container. To learn more about using AWS SAM to deploy your function code, see <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-using-build.html">Building applications</a> 
      in the <em>AWS SAM Developer Guide</em>.</p>
      <p>To create a .zip deployment package containing gems with native extensions without using AWS SAM, you can alternatively use a container to 
        bundle your dependencies in an environment that is the same as the Lambda Ruby runtime environment. To complete these steps, you must have Docker installed on your build 
        machine. To learn more about installing Docker, see <a href="https://docs.docker.com/engine/install/" rel="noopener noreferrer" target="_blank"><span>Install Docker Engine</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
      <div class="procedure"><h6>To create a .zip deployment package in a Docker container</h6><ol><li><p>Create a folder on your local build machine to save your container in. Inside that folder, create a file 
          named <code class="code">dockerfile</code> and paste the following code into it.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="dockerfile ">FROM public.ecr.aws/sam/build-ruby3.2:latest-x86_64
RUN gem update bundler 
CMD "/bin/bash"</code></pre>
        </li><li><p>Inside the folder you created your <code class="code">dockerfile</code> in, run the following command to create the Docker container.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">docker build -t awsruby32 .</code></code></pre>
        </li><li>
          <p>Navigate to the project directory containing the <code class="code">.rb</code> file with your function's handler code and the <code class="code">Gemfile</code> 
          specifying your function's dependencies. From inside that directory, run the following command to start the Lambda Ruby container.</p>
          <awsdocs-tabs><dl style="display: none">
            <dt>Linux/MacOS</dt><dd tab-id="linux/macos">
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">docker run --rm -it -v $PWD:/var/task -w /var/task awsruby32</code></code></pre>
                <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>In MacOS, you might see a warning informing you that the requested image's platform does not match the detected 
                  host platform. Ignore this warning.</p></div></div>
              </dd>
            <dt>Windows PowerShell</dt><dd tab-id="windows-powershell">
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">docker run --rm -it -v $<span>{</span>pwd}:var/task -w /var/task awsruby32</code></code></pre>
              </dd>
          </dl></awsdocs-tabs>
          <p>When your container starts, you should see a bash prompt.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">bash-4.2#</code></pre>
        </li><li>
          <p>Configure the bundle utility to install the gems specified in your <code class="code">Gemfile</code> in a local <code class="code">vendor/bundle</code> 
          directory and install your dependencies.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">bash-4.2# <code class="userinput">bundle config set --local path 'vendor/bundle' &amp;&amp; bundle install</code></code></pre>
        </li><li>
          <p>Create the .zip deployment package with your function code and its dependencies. In this example, the file containing your function's handler 
          code is named <code class="code">lambda_function.rb</code>.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">bash-4.2# <code class="userinput">zip -r my_deployment_package.zip lambda_function.rb vendor</code></code></pre>
        </li><li>
          <p>Exit the container and return to your local project directory.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">bash-4.2# <code class="userinput">exit</code></code></pre>
          <p>You can now use the .zip file deployment package to create or update your Lambda function. See <a href="#ruby-package-create-functions">Creating and updating Ruby Lambda functions using .zip files</a></p>
        </li></ol></div>
     
  <h2 id="ruby-package-create-functions">Creating and updating Ruby Lambda functions using .zip files</h2>
        <p>
      Once you have created your .zip deployment package, you can use it to create a new Lambda function or update an existing one. You can deploy 
      your .zip package using the Lambda console, the AWS Command Line Interface, and the Lambda API. You can also create and update Lambda functions using 
      AWS Serverless Application Model (AWS SAM) and AWS CloudFormation.
    </p>
    <p>The maximum size for a .zip deployment package for Lambda is 250 MB (unzipped). Note that this limit applies to the combined size of all the files you upload, 
    including any Lambda layers.</p>
         
          <h3 id="ruby-package-create-console">Creating and updating functions with .zip files using the console</h3>
          <p>
      To create a new function, you must first create the function in the console, then upload your .zip archive. To update an existing function, open the page for your function, then follow the same procedure to add your updated .zip file.
    </p>
<p>
      If your .zip file is less than 50MB, you can create or update a function by uploading the file directly from your local machine. For .zip files greater than 50MB, you must upload your package to an Amazon S3 bucket first. For instructions on how to upload a file to an Amazon S3 bucket using the AWS Management Console, see <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/GetStartedWithS3.html">Getting started with Amazon S3</a>. To upload files using the AWS CLI, see <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-services-s3-commands.html#using-s3-commands-managing-objects-move">Move objects</a> in the <em>AWS CLI User Guide</em>.
    </p>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You cannot convert an existing container image function to use a .zip archive. You must create a new function.</p></div></div>
  <div class="procedure"><h6>To create a new function (console)</h6><ol><li>
      <p>Open the <a href="https://console.aws.amazon.com/lambda/home#/functions" rel="noopener noreferrer" target="_blank"><span>Functions page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> of the Lambda console and choose <b>Create Function</b>.</p>
    </li><li>
      <p>Choose <b>Author from scratch</b>.</p>
    </li><li>
      <p>Under <b>Basic information</b>, do the following:</p>
      <ol><li>
          <p>For <b>Function name</b>, enter the name for your function.</p>
          </li><li>
              <p>For <b>Runtime</b>, select the runtime you want to use.</p>
            </li><li>
              <p>(Optional) For <b>Architecture</b>, choose the instruction set architecture for your function. The default architecture is x86_64. Ensure that the .zip deployment package for your function is compatible with the instruction set architecture you select.</p>
            </li></ol>
    </li><li>
      <p>(Optional) Under <b>Permissions</b>, expand <b>Change default execution role</b>. You can create a new <b>Execution role</b> or use an existing one.</p>
    </li><li>
      <p>Choose <b>Create function</b>. Lambda creates a basic 'Hello world' function using your chosen runtime.</p>
    </li></ol></div>
  <div class="procedure"><h6>To upload a .zip archive from your local machine (console)</h6><ol><li>
      <p>In the <a href="https://console.aws.amazon.com/lambda/home#/functions" rel="noopener noreferrer" target="_blank"><span>Functions page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> of the Lambda console, choose the function you want to upload the .zip file for.</p>
    </li><li>
      <p>Select the <b>Code</b> tab.</p>
    </li><li>
      <p>In the <b>Code source</b> pane, choose <b>Upload from</b>.</p>
    </li><li>
      <p>Choose <b>.zip file</b>.</p>
    </li><li>
      <p>To upload the .zip file, do the following:</p>
      <ol><li>
          <p>Select <b>Upload</b>, then select your .zip file in the file chooser.</p>
        </li><li>
          <p>Choose <b>Open</b>.</p>
        </li><li>
          <p>Choose <b>Save</b>.</p>
        </li></ol>
    </li></ol></div>
  
  <div class="procedure"><h6>To upload a .zip archive from an Amazon S3 bucket (console)</h6><ol><li>
      <p>In the <a href="https://console.aws.amazon.com/lambda/home#/functions" rel="noopener noreferrer" target="_blank"><span>Functions page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> of the Lambda console, choose the function you want to upload a new .zip file for.</p>
    </li><li>
      <p>Select the <b>Code</b> tab.</p>
    </li><li>
      <p>In the <b>Code source</b> pane, choose <b>Upload from</b>.</p>
    </li><li>
      <p>Choose <b>Amazon S3 location</b>.</p>
    </li><li>
      <p>Paste the Amazon S3 link URL of your .zip file and choose <b>Save</b>.</p>
    </li></ol></div>
         
         
          <h3 id="ruby-package-console-edit">Updating .zip file functions using the console code editor</h3>
          
         
        <p>
      For some functions with .zip deployment packages, you can use the Lambda console’s built-in code editor to update your function code directly. To use this feature, your function must meet the following criteria:
    </p>
    <div class="itemizedlist">
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>Your function must use one of the interpreted language runtimes (Python, Node.js, or Ruby)</p>
      </li><li class="listitem">
        <p>Your function’s deployment package must be smaller than 3MB.</p>
      </li></ul></div>
    <p>
      Function code for functions with container image deployment packages cannot be edited directly in the console.
    </p>
    <div class="procedure"><h6>To update function code using the console code editor</h6><ol><li>
        <p>Open the <a href="https://console.aws.amazon.com/lambda/home#/functions" rel="noopener noreferrer" target="_blank"><span>Functions page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> of the Lambda console and select your function.</p>
      </li><li>
        <p>Select the <b>Code</b> tab.</p>
      </li><li>
        <p>In the <b>Code source</b> pane, select your source code file and edit it in the integrated code editor.</p>
      </li><li>
        <p>When you have finished editing your code, choose <b>Deploy</b> to save your changes and update your function.</p>
      </li></ol></div>
         
          <h3 id="ruby-package-create-cli">Creating and updating functions with .zip files using the AWS CLI</h3>
          <p>
      You can can use the <a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html">AWS CLI</a> to create a new function or to update an existing one using a .zip file. Use the <a href="https://docs.aws.amazon.com/cli/latest/reference/lambda/create-function.html">create-function</a> 
      and <a href="https://docs.aws.amazon.com/cli/latest/reference/lambda/create-function.html">update-function-code</a> commands to deploy your .zip 
      package. If your .zip file is smaller than 50MB, you can upload the .zip package from a file location on your local build machine. For larger files, 
      you must upload your .zip package from an Amazon S3 bucket. For instructions on how to upload a file to an Amazon S3 bucket using the AWS CLI, see <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-services-s3-commands.html#using-s3-commands-managing-objects-move">Move objects</a> in the <em>AWS CLI User Guide</em>.
    </p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If you upload your .zip file from an Amazon S3 bucket using the AWS CLI, the bucket must be located in the same AWS Region as your function.</p></div></div>
    <p>
      To create a new function using a .zip file with the AWS CLI, you must specify the following:
    </p>
    <div class="itemizedlist">
       
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>The name of your function (<code class="code">--function-name</code>)</p>
      </li><li class="listitem">
        <p>Your function’s runtime (<code class="code">--runtime</code>)</p>
      </li><li class="listitem">
        <p>The Amazon Resource Name (ARN) of your function’s <a href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html">execution role</a> (<code class="code">--role</code>)</p>
      </li><li class="listitem">
        <p>The name of the handler method in your function code (<code class="code">--handler</code>)</p>
      </li></ul></div>
    <p>
      You must also specify the location of your .zip file. If your .zip file is located in a folder on your local build machine, use the <code class="code">--zip-file</code> option to specify the file path, as shown in the following example command.
    </p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda create-function --function-name myFunction \
--runtime ruby3.2 --handler lambda_function.lambda_handler \
--role arn:aws:iam::111122223333:role/service-role/my-lambda-role \
--zip-file fileb://myFunction.zip</code></code></pre>
    <p>
      To specify the location of .zip file in an Amazon S3 bucket, use the <code class="code">--code</code> option as shown in the following example command. You only 
      need to use the <code class="code">S3ObjectVersion</code> parameter for versioned objects.
    </p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda create-function --function-name myFunction \
--runtime ruby3.2 --handler lambda_function.lambda_handler \
--role arn:aws:iam::111122223333:role/service-role/my-lambda-role \
--code S3Bucket=myBucketName,S3Key=myFileName.zip,S3ObjectVersion=myObjectVersion</code></code></pre>
    <p>
      To update an existing function using the CLI, you specify the the name of your function using the <code class="code">--function-name</code> parameter. You 
      must also specify the location of the .zip file you want to use to update your function code. If your .zip file is located in a folder on your 
      local build machine, use the <code class="code">--zip-file</code> option to specify the file path, as shown in the following example command.
    </p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda update-function-code --function-name myFunction \
--zip-file fileb://myFunction.zip</code></code></pre>
    <p>
      To specify the location of .zip file in an Amazon S3 bucket, use the <code class="code">--s3-bucket</code> and <code class="code">--s3-key</code> options as shown in the 
      following example command. You only need to use the <code class="code">--s3-object-version</code> parameter for versioned objects.
    </p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda update-function-code --function-name myFunction \
--s3-bucket myBucketName --s3-key myFileName.zip --s3-object-version myObject Version</code></code></pre>
         
        
         
          <h3 id="ruby-package-create-api">Creating and updating functions with .zip files using the Lambda API</h3>
          <p>
      To create and update functions using a .zip file archive, use the following API operations:
    </p>
<div class="itemizedlist">
 
 
<ul class="itemizedlist"><li class="listitem">
<p><a href="https://docs.aws.amazon.com/lambda/latest/dg/API_CreateFunction.html">CreateFunction</a></p>
</li><li class="listitem">
<p><a href="https://docs.aws.amazon.com/lambda/latest/dg/API_UpdateFunctionCode.html">UpdateFunctionCode</a></p>
</li></ul></div>
         
         
          <h3 id="ruby-package-create-sam">Creating and updating functions with .zip files using AWS SAM</h3>
          <p>
      The AWS Serverless Application Model (AWS SAM) is a toolkit that helps streamline the process of building and running serverless applications on AWS. You define the resources for your application in a 
      YAML or JSON template and use the AWS SAM command line interface (AWS SAM CLI) to build, package, and deploy your applications. When you build a Lambda function from an AWS SAM template, 
      AWS SAM automatically creates a .zip deployment package or container image with your function code and any dependencies you specify. To learn more about using AWS SAM to build and deploy 
      Lambda functions, see <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-getting-started.html">Getting started with AWS SAM</a> in the
      <em>AWS Serverless Application Model Developer Guide</em>.</p>

      <p>You can also use AWS SAM to create a Lambda function using an existing .zip file archive. To create a Lambda function using AWS SAM, you can save your .zip file in 
      an Amazon S3 bucket or in a local folder on your build machine. For instructions on how to upload a file to an Amazon S3 bucket using the AWS CLI, 
      see <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-services-s3-commands.html#using-s3-commands-managing-objects-move">Move objects</a> in the <em>AWS CLI User Guide</em>.
    </p>
<p>
      In your AWS SAM template, the <code class="code">AWS::Serverless::Function</code> resource specifies your Lambda function. In this resource, set the following 
  properties to create a function using a .zip file archive:
    </p>
<div class="itemizedlist">
 
 
 
<ul class="itemizedlist"><li class="listitem">
<p><code class="code">PackageType</code> - set to <code class="code">Zip</code></p>
</li><li class="listitem">
<p><code class="code">CodeUri</code> - set to the  function code's Amazon S3 URI, path to local folder, or <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-property-function-functioncode.html">FunctionCode</a> object</p>
</li><li class="listitem">
<p><code class="code">Runtime</code> - Set to your chosen runtime</p>
</li></ul></div>
<p>
      With AWS SAM, if your .zip file is larger than 50MB, you don’t need to upload it to an Amazon S3 bucket first. AWS SAM can upload .zip packages up to 
      the maximum allowed size of 250MB (unzipped) from a location on your local build machine.
    </p>
<p>
      To learn more about deploying functions using .zip file in AWS SAM, see <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html">AWS::Serverless::Function</a> in the <em>AWS SAM Developer Guide</em>.
    </p>
         
         
          <h3 id="ruby-package-create-cfn">Creating and updating functions with .zip files using AWS CloudFormation</h3>
          <p>
      You can use AWS CloudFormation to create a Lambda function using a .zip file archive. To create a Lambda function from a .zip file, you must first upload 
      your file to an Amazon S3 bucket. For instructions on how to upload a file to an Amazon S3 bucket using the AWS CLI, see <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-services-s3-commands.html#using-s3-commands-managing-objects-move">Move objects</a> 
  in the <em>AWS CLI User Guide. </em></p>
  <p>In your AWS CloudFormation template, the <code class="code">AWS::Lambda::Function</code> resource specifies your Lambda function. In this resource, set the following 
    properties to create a function using a .zip file archive:</p>
<div class="itemizedlist">
 
 
 
<ul class="itemizedlist"><li class="listitem">
<p><code class="code">PackageType</code> - Set to <code class="code">Zip</code></p>
</li><li class="listitem">
<p><code class="code">Code</code> - Enter the Amazon S3 bucket name and the .zip file name in the <code class="code">S3Bucket</code> and <code class="code">S3Key</code> fields</p>
</li><li class="listitem">
<p><code class="code">Runtime</code> - Set to your chosen runtime</p>
</li></ul></div>
<p>
      The .zip file that AWS CloudFormation generates cannot exceed 4MB. To learn more about deploying functions using .zip file in AWS CloudFormation, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lambda-function.html">AWS::Lambda::Function</a> 
  in the <em>AWS CloudFormation User Guide</em>.
    </p>
         
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./ruby-handler.html">Handler</div><div id="next" class="next-link" accesskey="n" href="./ruby-image.html">Deploy container images</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/ruby-package.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/ruby-package.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>