<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS Lambda function logging in Java - AWS Lambda</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="java-logging" /><meta name="default_state" content="java-logging" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/java-logging.html" /><meta name="description" content="This page describes how to view Lambda function metrics using Amazon CloudWatch for the Java runtime." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Lambda" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="" /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/java-logging.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lambda/latest/dg/java-logging.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lambda/latest/dg/java-logging.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lambda/latest/dg/java-logging.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lambda/latest/dg/java-logging.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/java-logging.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/java-logging.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lambda/latest/dg/java-logging.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lambda/latest/dg/java-logging.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lambda/latest/dg/java-logging.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lambda/latest/dg/java-logging.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lambda/latest/dg/java-logging.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lambda/latest/dg/java-logging.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/java-logging.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/java-logging.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/java-logging.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/java-logging.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lambda/latest/dg/java-logging.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lambda/latest/dg/java-logging.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/lambda/latest/dg/java-logging.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/java-logging.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/java-logging.html" hreflang="x-default" /><meta name="feedback-item" content="Lambda" /><meta name="this_doc_product" content="AWS Lambda" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'lambda'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="AWS Lambda function logging in Java" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS Lambda function logging in Java - AWS Lambda</title><meta name="pdf" content="/pdfs/lambda/latest/dg/lambda-dg.pdf#java-logging" /><meta name="rss" content="lambda-updates.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=186" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/java-logging.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/java-logging.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/java-logging.html" /><meta name="keywords" content="Lambda,AWS Lambda,serverless,serverless applications,cloud computing,java runtimes,java lambda,java Lambda function" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Lambda",
        "item" : "https://docs.aws.amazon.com/lambda/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Building Lambda functions with Java",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/lambda-java.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "AWS Lambda function logging in Java",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/lambda-java.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/lambda/latest/dg/lambda-dg.pdf#java-logging" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/lambda/index.html">AWS Lambda</a><a href="welcome.html">Developer Guide</a></div><div id="page-toc-src"><a href="#java-tools-libraries">Tools and libraries</a><a href="#java-logging-output">Creating a function that returns logs</a><a href="#java-logging-sam">Using Powertools for AWS Lambda (Java) and AWS SAM for structured logging</a><a href="#java-logging-cdk">Using Powertools for AWS Lambda (Java) and the AWS CDK for structured logging</a><a href="#java-logging-console">Using the Lambda console</a><a href="#java-logging-cwconsole">Using the CloudWatch console</a><a href="#java-logging-cli">Using the AWS Command Line Interface (AWS CLI)</a><a href="#java-logging-delete">Deleting logs</a><a href="#java-logging-log4j2">Advanced logging with Log4j 2 and SLF4J</a><a href="#java-logging-samples">Sample logging code</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="java-logging">AWS Lambda function logging in Java</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>AWS Lambda automatically monitors Lambda functions and sends log entries to Amazon CloudWatch. Your Lambda function 
    comes with a CloudWatch Logs log group and a log stream for each instance of your function. The Lambda runtime environment 
    sends details about each invocation and other output from your function's 
    code to the log stream. For more information about CloudWatch Logs, see <a href="./monitoring-cloudwatchlogs.html">Accessing Amazon CloudWatch logs for AWS Lambda</a>.</p><p>To output logs from your function code, you can use methods on <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/System.html" rel="noopener noreferrer" target="_blank"><span>java.lang.System</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, or any logging 
    module that writes to stdout or stderr.</p><div class="highlights" id="inline-topiclist"><h6>Sections</h6><ul><li><a href="#java-tools-libraries">Tools and libraries</a></li><li><a href="#java-logging-output">Creating a function that returns logs</a></li><li><a href="#java-logging-sam">Using Powertools for AWS Lambda (Java) and AWS SAM for structured logging</a></li><li><a href="#java-logging-cdk">Using Powertools for AWS Lambda (Java) and the AWS CDK for structured logging</a></li><li><a href="#java-logging-console">Using the Lambda console</a></li><li><a href="#java-logging-cwconsole">Using the CloudWatch console</a></li><li><a href="#java-logging-cli">Using the AWS Command Line Interface (AWS CLI)</a></li><li><a href="#java-logging-delete">Deleting logs</a></li><li><a href="#java-logging-log4j2">Advanced logging with Log4j 2 and SLF4J</a></li><li><a href="#java-logging-samples">Sample logging code</a></li></ul></div>
    <h2 id="java-tools-libraries">Tools and libraries</h2>
    
    <p><a href="https://docs.powertools.aws.dev/lambda/java/" rel="noopener noreferrer" target="_blank"><span>Powertools for AWS Lambda (Java)</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> is a developer toolkit to implement Serverless best 
      practices and increase developer velocity. The <a href="https://docs.powertools.aws.dev/lambda/java/core/logging/" rel="noopener noreferrer" target="_blank"><span>Logging utility</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> 
      provides a Lambda optimized logger which includes additional information about function context across all your functions with output structured as JSON. Use this 
      utility to do the following:</p>
    <div class="itemizedlist">
       
       
       
       
       
    <ul class="itemizedlist"><li class="listitem"><p>Capture key fields from the Lambda context, cold start and structures logging output as JSON</p></li><li class="listitem"><p>Log Lambda invocation events when instructed (disabled by default)</p></li><li class="listitem"><p>Print all the logs only for a percentage of invocations via log sampling (disabled by default)</p></li><li class="listitem"><p>Append additional keys to structured log at any point in time</p></li><li class="listitem"><p>Use a custom log formatter (Bring Your Own Formatter) to output logs in a structure compatible with your organization’s Logging RFC</p></li></ul></div>
   
    <h2 id="java-logging-output">Creating a function that returns logs</h2>
  <p>To output logs from your function code, you can use methods on <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/System.html" rel="noopener noreferrer" target="_blank"><span>java.lang.System</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, or any logging
    module that writes to <code class="code">stdout</code> or <code class="code">stderr</code>. The <a href="./java-package.html">aws-lambda-java-core</a> library provides a logger class named <code class="code">LambdaLogger</code> that you can access
    from the context object. The logger class supports multiline logs.</p>
  
  <p>The following example uses the <code class="code">LambdaLogger</code> logger provided by the context object.</p>
  <div class="example"><h6>Example Handler.java</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">// Handler value: example.Handler
public class Handler implements RequestHandler&lt;Object, String&gt;<span>{</span>
  Gson gson = new GsonBuilder().setPrettyPrinting().create();
  @Override
  public String handleRequest(Object event, Context context)
  <span>{</span>
    <code class="userinput">LambdaLogger logger = context.getLogger();</code>
    String response = new String("SUCCESS");
    // log execution details
    <code class="userinput">logger.log("ENVIRONMENT VARIABLES: " + gson.toJson(System.getenv()));
    logger.log("CONTEXT: " + gson.toJson(context));</code>
    // process event
    <code class="userinput">logger.log("EVENT: " + gson.toJson(event));</code>
    return response;
  }
}</code></pre></div></div>
  
  <div class="example"><h6>Example log format</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">START RequestId: 6bc28136-xmpl-4365-b021-0ce6b2e64ab0 Version: $LATEST
ENVIRONMENT VARIABLES: 
<span>{</span>
    "_HANDLER": "example.Handler",
    "AWS_EXECUTION_ENV": "AWS_Lambda_java8",
    "AWS_LAMBDA_FUNCTION_MEMORY_SIZE": "512",
    ...
}
CONTEXT: 
<span>{</span>
    "memoryLimit": 512,
    "awsRequestId": "6bc28136-xmpl-4365-b021-0ce6b2e64ab0",
    "functionName": "java-console",
    ...
}
EVENT:
<span>{</span>
  "records": [
    <span>{</span>
      "messageId": "19dd0b57-xmpl-4ac1-bd88-01bbb068cb78",
      "receiptHandle": "MessageReceiptHandle",
      "body": "Hello from SQS!",
       ...
    }
  ]
}
END RequestId: 6bc28136-xmpl-4365-b021-0ce6b2e64ab0
REPORT RequestId: 6bc28136-xmpl-4365-b021-0ce6b2e64ab0	Duration: 198.50 ms	Billed Duration: 200 ms	Memory Size: 512 MB	Max Memory Used: 90 MB	Init Duration: 524.75 ms</code></pre></div></div>
  
  <p>The Java runtime logs the <code class="code">START</code>, <code class="code">END</code>, and <code class="code">REPORT</code> lines for each
    invocation. The report line provides the following details:</p>
   <div class="itemizedlist">
    <h6>REPORT line data fields</h6>
     
     
     
     
     
     
     
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p><b>RequestId</b> – The unique request ID for the invocation.</p>
    </li><li class="listitem">
      <p><b>Duration</b> – The amount of time that your function's handler method
        spent processing the event.</p>
    </li><li class="listitem">
      <p><b>Billed Duration</b> – The amount of time billed for the
        invocation.</p>
    </li><li class="listitem">
      <p><b>Memory Size</b> – The amount of memory allocated to the function.</p>
    </li><li class="listitem">
      <p><b>Max Memory Used</b> – The amount of memory used by the function.</p>
    </li><li class="listitem">
      <p><b>Init Duration</b> – For the first request served, the amount of time it
        took the runtime to load the function and run code outside of the handler method.</p>
    </li><li class="listitem">
      <p><b>XRAY TraceId</b> – For traced requests, the <a href="./services-xray.html">AWS X-Ray trace ID</a>.</p>
    </li><li class="listitem">
      <p><b>SegmentId</b> – For traced requests, the X-Ray segment ID.</p>
    </li><li class="listitem">
      <p><b>Sampled</b> – For traced requests, the sampling result.</p>
    </li></ul></div>
 
    <h2 id="java-logging-sam">Using Powertools for AWS Lambda (Java) and AWS SAM for structured logging</h2>
    <p>Follow the steps below to download, build, and deploy a sample Hello World Java application with integrated <a href="https://docs.powertools.aws.dev/lambda-java" rel="noopener noreferrer" target="_blank"><span>Powertools for AWS Lambda (Java)~</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> modules using the AWS SAM. This application implements a 
      basic API backend and uses Powertools for emitting logs, metrics, and traces. It consists of an Amazon API Gateway endpoint and a Lambda function. 
      When you send a GET request to the API Gateway endpoint, the Lambda function invokes, sends logs and metrics using Embedded Metric Format to CloudWatch, and 
      sends traces to AWS X-Ray. The function returns a <code class="code">hello world</code> message.</p>
    <div class="itemizedlist">
    <h6>Prerequisites</h6>
    <p>To complete the steps in this section, you must have the following:</p>
     
     
     
<ul class="itemizedlist"><li class="listitem">
      <p>Java 11</p>
    </li><li class="listitem">
      <p><a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html">AWS CLI version 2</a></p>
    </li><li class="listitem">
      <p><a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-install.html">AWS SAM CLI version 1.75 or later</a>. If you have an older version of the AWS SAM CLI, see <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/manage-sam-cli-versions.html#manage-sam-cli-versions-upgrade">Upgrading the AWS SAM CLI</a>.</p>
    </li></ul></div>
    <div class="procedure"><h6>Deploy a sample AWS SAM application</h6><ol><li>
        <p>Initialize the application using the Hello World Java template.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">sam init --app-template hello-world-powertools-java --name sam-app --package-type Zip --runtime java11 --no-tracing</code></pre>
      </li><li>
        <p>Build the app.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">cd sam-app &amp;&amp; sam build</code></pre>
      </li><li>
        <p>Deploy the app.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">sam deploy --guided</code></pre>
      </li><li>
        <p>Follow the on-screen prompts. To accept the default options provided in the interactive experience, press <code class="code">Enter</code>.</p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>For <b>HelloWorldFunction may not have authorization defined, Is this okay?</b>, make sure to enter <code class="code">y</code>.</p></div></div>
      </li><li>
        <p>Get the URL of the deployed application:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">aws cloudformation describe-stacks --stack-name sam-app --query 'Stacks[0].Outputs[?OutputKey==`HelloWorldApi`].OutputValue' --output text</code></pre>
      </li><li>
        <p>Invoke the API endpoint:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">curl -X GET <code class="replaceable">&lt;URL_FROM_PREVIOUS_STEP&gt;</code></code></pre>
        <p>If successful, you'll see this response:</p>
        <pre class="programlisting"><div class="code-btn-container"></div><code class=""><span>{</span>"message":"hello world"}</code></pre>
      </li><li>
        <p>To get the logs for the function, run <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-cli-command-reference-sam-logs.html">sam logs</a>. For more information, see <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-logging.html">Working with logs</a> in the <em>AWS Serverless Application Model Developer Guide</em>.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">sam logs --stack-name sam-app</code></pre> 
        <p>The log output looks like this:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:34.095000 INIT_START Runtime Version: java:11.v15    Runtime Version ARN: arn:aws:lambda:eu-central-1::runtime:0a25e3e7a1cc9ce404bc435eeb2ad358d8fa64338e618d0c224fe509403583ca
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:34.114000 Picked up JAVA_TOOL_OPTIONS: -XX:+TieredCompilation -XX:TieredStopAtLevel=1
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:34.793000 Transforming org/apache/logging/log4j/core/lookup/JndiLookup (lambdainternal.CustomerClassLoader@1a6c5a9e)
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:35.252000 START RequestId: 7fcf1548-d2d4-41cd-a9a8-6ae47c51f765 Version: $LATEST
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:36.531000 <span>{</span>
  "_aws": <span>{</span>
    "Timestamp": 1675416276051,
    "CloudWatchMetrics": [
      <span>{</span>
        "Namespace": "sam-app-powerools-java",
        "Metrics": [
          <span>{</span>
            "Name": "ColdStart",
            "Unit": "Count"
          }
        ],
        "Dimensions": [
          [
            "Service",
            "FunctionName"
          ]
        ]
      }
    ]
  },
  "function_request_id": "7fcf1548-d2d4-41cd-a9a8-6ae47c51f765",
  "traceId": "Root=1-63dcd2d1-25f90b9d1c753a783547f4dd;Parent=e29684c1be352ce4;Sampled=1",
  "FunctionName": "sam-app-HelloWorldFunction-y9Iu1FLJJBGD",
  "functionVersion": "$LATEST",
  "ColdStart": 1.0,
  "Service": "service_undefined",
  "logStreamId": "2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81",
  "executionEnvironment": "AWS_Lambda_java11"
}
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:36.974000 Feb 03, 2023 9:24:36 AM com.amazonaws.xray.AWSXRayRecorder &lt;init&gt;
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:36.993000 Feb 03, 2023 9:24:36 AM com.amazonaws.xray.config.DaemonConfiguration &lt;init&gt;
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:36.993000 INFO: Environment variable AWS_XRAY_DAEMON_ADDRESS is set. Emitting to daemon on address XXXX.XXXX.XXXX.XXXX:2000.
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:37.331000 09:24:37.294 [main] INFO  helloworld.App - <span>{</span>"version":null,"resource":"/hello","path":"/hello/","httpMethod":"GET","headers":<span>{</span>"Accept":"*/*","CloudFront-Forwarded-Proto":"https","CloudFront-Is-Desktop-Viewer":"true","CloudFront-Is-Mobile-Viewer":"false","CloudFront-Is-SmartTV-Viewer":"false","CloudFront-Is-Tablet-Viewer":"false","CloudFront-Viewer-ASN":"16509","CloudFront-Viewer-Country":"IE","Host":"XXXX.execute-api.eu-central-1.amazonaws.com","User-Agent":"curl/7.86.0","Via":"2.0 f0300a9921a99446a44423d996042050.cloudfront.net (CloudFront)","X-Amz-Cf-Id":"t9W5ByT11HaY33NM8YioKECn_4eMpNsOMPfEVRczD7T1RdhbtiwV1Q==","X-Amzn-Trace-Id":"Root=1-63dcd2d1-25f90b9d1c753a783547f4dd","X-Forwarded-For":"XX.XXX.XXX.XX, XX.XXX.XXX.XX","X-Forwarded-Port":"443","X-Forwarded-Proto":"https"},"multiValueHeaders":<span>{</span>"Accept":["*/*"],"CloudFront-Forwarded-Proto":["https"],"CloudFront-Is-Desktop-Viewer":["true"],"CloudFront-Is-Mobile-Viewer":["false"],"CloudFront-Is-SmartTV-Viewer":["false"],"CloudFront-Is-Tablet-Viewer":["false"],"CloudFront-Viewer-ASN":["16509"],"CloudFront-Viewer-Country":["IE"],"Host":["XXXX.execute-api.eu-central-1.amazonaws.com"],"User-Agent":["curl/7.86.0"],"Via":["2.0 f0300a9921a99446a44423d996042050.cloudfront.net (CloudFront)"],"X-Amz-Cf-Id":["t9W5ByT11HaY33NM8YioKECn_4eMpNsOMPfEVRczD7T1RdhbtiwV1Q=="],"X-Amzn-Trace-Id":["Root=1-63dcd2d1-25f90b9d1c753a783547f4dd"],"X-Forwarded-For":["XXX, XXX"],"X-Forwarded-Port":["443"],"X-Forwarded-Proto":["https"]},"queryStringParameters":null,"multiValueQueryStringParameters":null,"pathParameters":null,"stageVariables":null,"requestContext":<span>{</span>"accountId":"XXX","stage":"Prod","resourceId":"at73a1","requestId":"ba09ecd2-acf3-40f6-89af-fad32df67597","operationName":null,"identity":<span>{</span>"cognitoIdentityPoolId":null,"accountId":null,"cognitoIdentityId":null,"caller":null,"apiKey":null,"principalOrgId":null,"sourceIp":"54.240.197.236","cognitoAuthenticationType":null,"cognitoAuthenticationProvider":null,"userArn":null,"userAgent":"curl/7.86.0","user":null,"accessKey":null},"resourcePath":"/hello","httpMethod":"GET","apiId":"XXX","path":"/Prod/hello/","authorizer":null},"body":null,"isBase64Encoded":false}
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:37.351000 09:24:37.351 [main] INFO  helloworld.App - Retrieving https://checkip.amazonaws.com
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:39.313000 <span>{</span>
  "function_request_id": "7fcf1548-d2d4-41cd-a9a8-6ae47c51f765",
  "traceId": "Root=1-63dcd2d1-25f90b9d1c753a783547f4dd;Parent=e29684c1be352ce4;Sampled=1",
  "xray_trace_id": "1-63dcd2d1-25f90b9d1c753a783547f4dd",
  "functionVersion": "$LATEST",
  "Service": "service_undefined",
  "logStreamId": "2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81",
  "executionEnvironment": "AWS_Lambda_java11"
}
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:39.371000 END RequestId: 7fcf1548-d2d4-41cd-a9a8-6ae47c51f765
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:39.371000 REPORT RequestId: 7fcf1548-d2d4-41cd-a9a8-6ae47c51f765    Duration: 4118.98 ms    Billed Duration: 4119 ms    Memory Size: 512 MB    Max Memory Used: 152 MB    Init Duration: 1155.47 ms    
XRAY TraceId: 1-63dcd2d1-25f90b9d1c753a783547f4dd    SegmentId: 3a028fee19b895cb    Sampled: true</code></pre>
      </li><li>
        <p>This is a public API endpoint that is accessible over the internet. We recommend that you delete the endpoint after testing.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">sam delete</code></pre> 
      </li></ol></div>
     
      <h3 id="java-log-retention">Managing log retention</h3>
      <p>Log groups aren't deleted automatically when you delete a function. To avoid storing logs indefinitely, delete
        the log group, or configure a retention period after which CloudWatch automatically deletes the logs. To set up log retention, add the following to your AWS SAM template:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">Resources:
  HelloWorldFunction:
    Type: AWS::Serverless::Function
    Properties:
      # Omitting other properties

  LogGroup:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: !Sub "/aws/lambda/$<span>{</span>HelloWorldFunction}"
      RetentionInDays: 7</code></pre>
     
   
    <h2 id="java-logging-cdk">Using Powertools for AWS Lambda (Java) and the AWS CDK for structured logging</h2>
    <p>Follow the steps below to download, build, and deploy a sample Hello World Java application with integrated <a href="https://docs.powertools.aws.dev/lambda-java" rel="noopener noreferrer" target="_blank"><span>Powertools for AWS Lambda (Java)</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> modules using the AWS CDK. This application implements a 
      basic API backend and uses Powertools for emitting logs, metrics, and traces. It consists of an Amazon API Gateway endpoint and a Lambda function. 
      When you send a GET request to the API Gateway endpoint, the Lambda function invokes, sends logs and metrics using Embedded Metric Format to CloudWatch, and 
      sends traces to AWS X-Ray. The function returns a hello world message.</p>
    <div class="itemizedlist">
      <h6>Prerequisites</h6>
      <p>To complete the steps in this section, you must have the following:</p>
       
       
       
       
    <ul class="itemizedlist"><li class="listitem">
          <p>Java 11</p>
      </li><li class="listitem">
          <p><a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html">AWS CLI version 2</a></p>
      </li><li class="listitem">
          <p><a href="https://docs.aws.amazon.com/cdk/v2/guide/getting_started.html#getting_started_prerequisites">AWS CDK version 2</a></p>
      </li><li class="listitem">
        <p><a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-install.html">AWS SAM CLI version 1.75 or later</a>. If you have an older version of the AWS SAM CLI, see <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/manage-sam-cli-versions.html#manage-sam-cli-versions-upgrade">Upgrading the AWS SAM CLI</a>.</p>
      </li></ul></div>
    <div class="procedure"><h6>Deploy a sample AWS CDK application</h6><ol><li>
        <p>Create a project directory for your new application.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">mkdir hello-world
cd hello-world</code></pre>
      </li><li>
        <p>Initialize the app.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">cdk init app --language java</code></pre>
      </li><li>
        <p>Create a maven project with the following command:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">mkdir app
cd app
mvn archetype:generate -DgroupId=helloworld -DartifactId=Function -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false</code></pre>
      </li><li><p>Open <code class="code">pom.xml</code> in the <code class="code">hello-world\app\Function</code> directory and replace the existing code with the following code that includes dependencies and maven plugins for Powertools.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;helloworld&lt;/groupId&gt;
  &lt;artifactId&gt;Function&lt;/artifactId&gt;
  &lt;packaging&gt;jar&lt;/packaging&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;name&gt;Function&lt;/name&gt;
  &lt;url&gt;http://maven.apache.org&lt;/url&gt;
&lt;properties&gt;
    &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;
    &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;
    &lt;log4j.version&gt;2.17.2&lt;/log4j.version&gt;
&lt;/properties&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;3.8.1&lt;/version&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;software.amazon.lambda&lt;/groupId&gt;
            &lt;artifactId&gt;powertools-tracing&lt;/artifactId&gt;
            &lt;version&gt;1.3.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;software.amazon.lambda&lt;/groupId&gt;
            &lt;artifactId&gt;powertools-metrics&lt;/artifactId&gt;
            &lt;version&gt;1.3.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;software.amazon.lambda&lt;/groupId&gt;
            &lt;artifactId&gt;powertools-logging&lt;/artifactId&gt;
            &lt;version&gt;1.3.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;
            &lt;artifactId&gt;aws-lambda-java-core&lt;/artifactId&gt;
            &lt;version&gt;1.2.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.amazonaws&lt;/groupId&gt;
            &lt;artifactId&gt;aws-lambda-java-events&lt;/artifactId&gt;
            &lt;version&gt;3.11.1&lt;/version&gt;
        &lt;/dependency&gt;
  &lt;/dependencies&gt;
&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
            &lt;artifactId&gt;aspectj-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;1.14.0&lt;/version&gt;
            &lt;configuration&gt;
                &lt;source&gt;$<span>{</span>maven.compiler.source}&lt;/source&gt;
                &lt;target&gt;$<span>{</span>maven.compiler.target}&lt;/target&gt;
                &lt;complianceLevel&gt;$<span>{</span>maven.compiler.target}&lt;/complianceLevel&gt;
                &lt;aspectLibraries&gt;
                    &lt;aspectLibrary&gt;
                        &lt;groupId&gt;software.amazon.lambda&lt;/groupId&gt;
                        &lt;artifactId&gt;powertools-tracing&lt;/artifactId&gt;
                    &lt;/aspectLibrary&gt;
                    &lt;aspectLibrary&gt;
                        &lt;groupId&gt;software.amazon.lambda&lt;/groupId&gt;
                        &lt;artifactId&gt;powertools-metrics&lt;/artifactId&gt;
                    &lt;/aspectLibrary&gt;
                    &lt;aspectLibrary&gt;
                        &lt;groupId&gt;software.amazon.lambda&lt;/groupId&gt;
                        &lt;artifactId&gt;powertools-logging&lt;/artifactId&gt;
                    &lt;/aspectLibrary&gt;
                &lt;/aspectLibraries&gt;
            &lt;/configuration&gt;
            &lt;executions&gt;
                &lt;execution&gt;
                    &lt;goals&gt;
                        &lt;goal&gt;compile&lt;/goal&gt;
                    &lt;/goals&gt;
                &lt;/execution&gt;
            &lt;/executions&gt;
        &lt;/plugin&gt;
        &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.4.1&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;phase&gt;package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;shade&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;transformers&gt;
                                &lt;transformer
                                        implementation="com.github.edwgiz.maven_shade_plugin.log4j2_cache_transformer.PluginsCacheFileTransformer"&gt;
                                &lt;/transformer&gt;
                            &lt;/transformers&gt;
                            &lt;createDependencyReducedPom&gt;false&lt;/createDependencyReducedPom&gt;
                            &lt;finalName&gt;function&lt;/finalName&gt;

                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
                &lt;dependencies&gt;
                    &lt;dependency&gt;
                        &lt;groupId&gt;com.github.edwgiz&lt;/groupId&gt;
                        &lt;artifactId&gt;maven-shade-plugin.log4j2-cachefile-transformer&lt;/artifactId&gt;
                        &lt;version&gt;2.15&lt;/version&gt;
                    &lt;/dependency&gt;
                &lt;/dependencies&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;
&lt;/project&gt;
</code></pre></li><li><p>Create  the <code class="code">hello-world\app\src\main\resource</code> directory and create <code class="code">log4j.xml</code> for the log configuration.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">mkdir -p src/main/resource
cd src/main/resource
touch log4j.xml</code></pre></li><li>
        <p>Open <code class="code">log4j.xml</code> and add the following code.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Configuration&gt;
    &lt;Appenders&gt;
        &lt;Console name="JsonAppender" target="SYSTEM_OUT"&gt;
            &lt;JsonTemplateLayout eventTemplateUri="classpath:LambdaJsonLayout.json" /&gt;
        &lt;/Console&gt;
    &lt;/Appenders&gt;
    &lt;Loggers&gt;
        &lt;Logger name="JsonLogger" level="INFO" additivity="false"&gt;
            &lt;AppenderRef ref="JsonAppender"/&gt;
        &lt;/Logger&gt;
        &lt;Root level="info"&gt;
            &lt;AppenderRef ref="JsonAppender"/&gt;
        &lt;/Root&gt;
    &lt;/Loggers&gt;
&lt;/Configuration&gt;</code></pre>
      </li><li><p>Open <code class="code">App.java</code> from the <code class="code">hello-world\app\Function\src\main\java\helloworld</code> directory and replace the existing code with the following code. 
        This is the code for the Lambda function.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">package helloworld;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.URL;
import java.util.HashMap;
import java.util.Map;
import java.util.stream.Collectors;

import com.amazonaws.services.lambda.runtime.Context;
import com.amazonaws.services.lambda.runtime.RequestHandler;
import com.amazonaws.services.lambda.runtime.events.APIGatewayProxyRequestEvent;
import com.amazonaws.services.lambda.runtime.events.APIGatewayProxyResponseEvent;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import software.amazon.lambda.powertools.logging.Logging;
import software.amazon.lambda.powertools.metrics.Metrics;
import software.amazon.lambda.powertools.tracing.CaptureMode;
import software.amazon.lambda.powertools.tracing.Tracing;

import static software.amazon.lambda.powertools.tracing.CaptureMode.*;

/**
 * Handler for requests to Lambda function.
 */
public class App implements RequestHandler&lt;APIGatewayProxyRequestEvent, APIGatewayProxyResponseEvent&gt; <span>{</span>
    Logger log = LogManager.getLogger(App.class);


    @Logging(logEvent = true)
    @Tracing(captureMode = DISABLED)
    @Metrics(captureColdStart = true)
    public APIGatewayProxyResponseEvent handleRequest(final APIGatewayProxyRequestEvent input, final Context context) <span>{</span>
        Map&lt;String, String&gt; headers = new HashMap&lt;&gt;();
        headers.put("Content-Type", "application/json");
        headers.put("X-Custom-Header", "application/json");

        APIGatewayProxyResponseEvent response = new APIGatewayProxyResponseEvent()
                .withHeaders(headers);
        try <span>{</span>
            final String pageContents = this.getPageContents("https://checkip.amazonaws.com");
            String output = String.format("<span>{</span> \"message\": \"hello world\", \"location\": \"%s\" }", pageContents);

            return response
                    .withStatusCode(200)
                    .withBody(output);
        } catch (IOException e) <span>{</span>
            return response
                    .withBody("<span>{</span>}")
                    .withStatusCode(500);
        }
    }
    @Tracing(namespace = "getPageContents")
    private String getPageContents(String address) throws IOException <span>{</span>
        log.info("Retrieving <span>{</span>}", address);
        URL url = new URL(address);
        try (BufferedReader br = new BufferedReader(new InputStreamReader(url.openStream()))) <span>{</span>
            return br.lines().collect(Collectors.joining(System.lineSeparator()));
        }
    }
}</code></pre></li><li>
        <p>Open <code class="code">HelloWorldStack.java</code> from the <code class="code">hello-world\src\main\java\com\myorg</code> directory and replace the existing code with the following code. This code uses 
          <a href="https://docs.aws.amazon.com/cdk/api/v1/java/aws_cdk.aws_lambda.html">Lambda Constructor</a>and the 
          <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2-readme.html">ApiGatewayv2 Constructor</a> 
          to create a REST API and a Lambda function.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">package com.myorg;

import software.amazon.awscdk.*;
import software.amazon.awscdk.services.apigatewayv2.alpha.*;
import software.amazon.awscdk.services.apigatewayv2.integrations.alpha.HttpLambdaIntegration;
import software.amazon.awscdk.services.apigatewayv2.integrations.alpha.HttpLambdaIntegrationProps;
import software.amazon.awscdk.services.lambda.Code;
import software.amazon.awscdk.services.lambda.Function;
import software.amazon.awscdk.services.lambda.FunctionProps;
import software.amazon.awscdk.services.lambda.Runtime;
import software.amazon.awscdk.services.logs.RetentionDays;
import software.amazon.awscdk.services.s3.assets.AssetOptions;
import software.constructs.Construct;

import java.util.Arrays;
import java.util.List;

import static java.util.Collections.singletonList;
import static software.amazon.awscdk.BundlingOutput.ARCHIVED;

public class HelloWorldStack extends Stack <span>{</span>
    public HelloWorldStack(final Construct scope, final String id) <span>{</span>
        this(scope, id, null);
    }

    public HelloWorldStack(final Construct scope, final String id, final StackProps props) <span>{</span>
        super(scope, id, props);

        List&lt;String&gt; functionPackagingInstructions = Arrays.asList(
                "/bin/sh",
                "-c",
                "cd Function " +
                        "&amp;&amp; mvn clean install " +
                        "&amp;&amp; cp /asset-input/Function/target/function.jar /asset-output/"
        );
        BundlingOptions.Builder builderOptions = BundlingOptions.builder()
                .command(functionPackagingInstructions)
                .image(Runtime.JAVA_11.getBundlingImage())
                .volumes(singletonList(
                        // Mount local .m2 repo to avoid download all the dependencies again inside the container
                        DockerVolume.builder()
                                .hostPath(System.getProperty("user.home") + "/.m2/")
                                .containerPath("/root/.m2/")
                                .build()
                ))
                .user("root")
                .outputType(ARCHIVED);

        Function function = new Function(this, "Function", FunctionProps.builder()
                .runtime(Runtime.JAVA_11)
                .code(Code.fromAsset("app", AssetOptions.builder()
                        .bundling(builderOptions
                                .command(functionPackagingInstructions)
                                .build())
                        .build()))
                .handler("helloworld.App::handleRequest")
                .memorySize(1024)
                .timeout(Duration.seconds(10))
                .logRetention(RetentionDays.ONE_WEEK)
                .build());

        HttpApi httpApi = new HttpApi(this, "sample-api", HttpApiProps.builder()
                .apiName("sample-api")
                .build());

        httpApi.addRoutes(AddRoutesOptions.builder()
                .path("/")
                .methods(singletonList(HttpMethod.GET))
                .integration(new HttpLambdaIntegration("function", function, HttpLambdaIntegrationProps.builder()
                        .payloadFormatVersion(PayloadFormatVersion.VERSION_2_0)
                        .build()))
                .build());

        new CfnOutput(this, "HttpApi", CfnOutputProps.builder()
                .description("Url for Http Api")
                .value(httpApi.getApiEndpoint())
                .build());
    }
}</code></pre>
      </li><li><p>Open <code class="code">pom.xml</code> from the <code class="code">hello-world</code> directory and replace the existing code with the following code.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"
         xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.myorg&lt;/groupId&gt;
    &lt;artifactId&gt;hello-world&lt;/artifactId&gt;
    &lt;version&gt;0.1&lt;/version&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;cdk.version&gt;2.70.0&lt;/cdk.version&gt;
        &lt;constructs.version&gt;[10.0.0,11.0.0)&lt;/constructs.version&gt;
        &lt;junit.version&gt;5.7.1&lt;/junit.version&gt;
    &lt;/properties&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.8.1&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;source&gt;1.8&lt;/source&gt;
                    &lt;target&gt;1.8&lt;/target&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;

            &lt;plugin&gt;
                &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
                &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.0.0&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;mainClass&gt;com.myorg.HelloWorldApp&lt;/mainClass&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    &lt;dependencies&gt;
        &lt;!-- AWS Cloud Development Kit --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;software.amazon.awscdk&lt;/groupId&gt;
            &lt;artifactId&gt;aws-cdk-lib&lt;/artifactId&gt;
            &lt;version&gt;$<span>{</span>cdk.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;software.constructs&lt;/groupId&gt;
            &lt;artifactId&gt;constructs&lt;/artifactId&gt;
            &lt;version&gt;$<span>{</span>constructs.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;
          &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;
          &lt;version&gt;$<span>{</span>junit.version}&lt;/version&gt;
          &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;software.amazon.awscdk&lt;/groupId&gt;
            &lt;artifactId&gt;apigatewayv2-alpha&lt;/artifactId&gt;
            &lt;version&gt;$<span>{</span>cdk.version}-alpha.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;software.amazon.awscdk&lt;/groupId&gt;
            &lt;artifactId&gt;apigatewayv2-integrations-alpha&lt;/artifactId&gt;
            &lt;version&gt;$<span>{</span>cdk.version}-alpha.0&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;</code></pre></li><li>
        <p>Make sure you’re in the <code class="code">hello-world</code> directory and deploy your application.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">cdk deploy</code></pre>
      </li><li>
        <p>Get the URL of the deployed application:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">aws cloudformation describe-stacks --stack-name HelloWorldStack --query 'Stacks[0].Outputs[?OutputKey==`HttpApi`].OutputValue' --output text</code></pre>
      </li><li>
        <p>Invoke the API endpoint:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">curl -X GET <code class="replaceable">&lt;URL_FROM_PREVIOUS_STEP&gt;</code></code></pre>
        <p>If successful, you'll see this response:</p>
        <pre class="programlisting"><div class="code-btn-container"></div><code class=""><span>{</span>"message":"hello world"}</code></pre>
      </li><li>
        <p>To get the logs for the function, run <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-cli-command-reference-sam-logs.html">sam logs</a>. For more information, see <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-logging.html">Working with logs</a> in the <em>AWS Serverless Application Model Developer Guide</em>.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">sam logs --stack-name HelloWorldStack</code></pre> 
        <p>The log output looks like this:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:34.095000 INIT_START Runtime Version: java:11.v15    Runtime Version ARN: arn:aws:lambda:eu-central-1::runtime:0a25e3e7a1cc9ce404bc435eeb2ad358d8fa64338e618d0c224fe509403583ca
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:34.114000 Picked up JAVA_TOOL_OPTIONS: -XX:+TieredCompilation -XX:TieredStopAtLevel=1
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:34.793000 Transforming org/apache/logging/log4j/core/lookup/JndiLookup (lambdainternal.CustomerClassLoader@1a6c5a9e)
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:35.252000 START RequestId: 7fcf1548-d2d4-41cd-a9a8-6ae47c51f765 Version: $LATEST
2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81 2023-02-03T09:24:36.531000 <span>{</span>
  "_aws": <span>{</span>
    "Timestamp": 1675416276051,
    "CloudWatchMetrics": [
      <span>{</span>
        "Namespace": "sam-app-powerools-java",
        "Metrics": [
          <span>{</span>
            "Name": "ColdStart",
            "Unit": "Count"
          }
        ],
        "Dimensions": [
          [
            "Service",
            "FunctionName"
          ]
        ]
      }
    ]
  },
  "function_request_id": "7fcf1548-d2d4-41cd-a9a8-6ae47c51f765",
  "traceId": "Root=1-63dcd2d1-25f90b9d1c753a783547f4dd;Parent=e29684c1be352ce4;Sampled=1",
  "FunctionName": "sam-app-HelloWorldFunction-y9Iu1FLJJBGD",
  "functionVersion": "$LATEST",
  "ColdStart": 1.0,
  "Service": "service_undefined",
  "logStreamId": "2023/02/03/[$LATEST]851411a899b545eea2cffeba4cfbec81",
  "executionEnvironment": "AWS_Lambda_java11"
}</code></pre> 
      </li><li>
        <p>This is a public API endpoint that is accessible over the internet. We recommend that you delete the endpoint after testing.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">cdk destroy</code></pre> 
      </li></ol></div>
   
    <h2 id="java-logging-console">Using the Lambda console</h2>
       
      
  <p>You can use the Lambda console to view log output after you invoke a Lambda function.</p>
  <p>If your code can be tested from the embedded <b>Code</b> editor, you will find logs in the <b>execution results</b>. When you use the console test feature to invoke a function, you'll find <b>Log output</b> in the <b>Details</b> section.</p>

   
    <h2 id="java-logging-cwconsole">Using the CloudWatch console</h2>
     
    
    <p>You can use the Amazon CloudWatch console to view logs for all Lambda function invocations.</p>
    <div class="procedure"><h6>To view logs on the CloudWatch console</h6><ol><li>
        <p>Open the <a href="https://console.aws.amazon.com/cloudwatch/home?#logs:" rel="noopener noreferrer" target="_blank"><span>Log groups page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> on the CloudWatch console.</p>
      </li><li>
        <p>Choose the log group for your function (<b>/aws/lambda/<code class="replaceable">your-function-name</code></b>).</p>
      </li><li>
        <p>Choose a log stream.</p>
      </li></ol></div>
    <p>Each log stream corresponds to an <a href="./lambda-runtime-environment.html">instance of your function</a>. A log stream appears when you update your Lambda function, and when additional instances are created to handle multiple concurrent invocations. To find logs for a specific invocation, we recommend instrumenting your function with AWS X-Ray. X-Ray records details about the request and the log stream in the trace.</p>
    <p>To use a sample application that correlates logs and traces with X-Ray, see <a href="./samples-errorprocessor.html">Error processor sample application for AWS Lambda</a>.</p>

   
    <h2 id="java-logging-cli">Using the AWS Command Line Interface (AWS CLI)</h2>
       
      
    <p>The AWS CLI is an open-source tool that enables you to interact with AWS services using commands in your command line shell. To complete the steps in this section, you must have the following:</p>
    <div class="itemizedlist">
         
         
    <ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html">AWS Command Line Interface (AWS CLI) version 2</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html">AWS CLI – Quick configuration with <code class="code">aws configure</code></a></p></li></ul></div>

       
      
    <p>You can use the <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-welcome.html">AWS CLI</a> to retrieve logs for an invocation using the <code class="code">--log-type</code> command option. The response contains a <code class="code">LogResult</code> field that contains up to 4 KB of base64-encoded logs from the invocation.</p>
    <div class="example"><h6>Example retrieve a log ID</h6><div class="example-contents"><p>The following example shows how to retrieve a <em>log ID</em> from the <code class="code">LogResult</code> field for a function named <code class="code">my-function</code>.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda invoke --function-name my-function out --log-type Tail</code></code></pre><p>You should see the following output:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "StatusCode": 200,
    "LogResult": "U1RBUlQgUmVxdWVzdElkOiA4N2QwNDRiOC1mMTU0LTExZTgtOGNkYS0yOTc0YzVlNGZiMjEgVmVyc2lvb...",
    "ExecutedVersion": "$LATEST"
}</code></pre></div></div>
<div class="example"><h6>Example decode the logs</h6><div class="example-contents"><p>In the same command prompt, use the <code class="code">base64</code> utility to decode the logs. The following example shows how to retrieve base64-encoded logs for <code class="code">my-function</code>.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws lambda invoke --function-name my-function out --log-type Tail \
--query 'LogResult' --output text --cli-binary-format raw-in-base64-out | base64 --decode</code></code></pre><p>The <b>cli-binary-format</b> option is required if you're using AWS CLI version 2. To make this the default setting, run <code class="code">aws configure set cli-binary-format raw-in-base64-out</code>. For more information, see <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-options.html#cli-configure-options-list">AWS CLI supported global command line options</a>.</p><p>You should see the following output:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">START RequestId: 57f231fb-1730-4395-85cb-4f71bd2b87b8 Version: $LATEST
"AWS_SESSION_TOKEN": "AgoJb3JpZ2luX2VjELj...", "_X_AMZN_TRACE_ID": "Root=1-5d02e5ca-f5792818b6fe8368e5b51d50;Parent=191db58857df8395;Sampled=0"",ask/lib:/opt/lib",
END RequestId: 57f231fb-1730-4395-85cb-4f71bd2b87b8
REPORT RequestId: 57f231fb-1730-4395-85cb-4f71bd2b87b8  Duration: 79.67 ms      Billed Duration: 80 ms         Memory Size: 128 MB     Max Memory Used: 73 MB</code></pre><p>The <code class="code">base64</code> utility is available on Linux, macOS, and <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" rel="noopener noreferrer" target="_blank"><span>Ubuntu on Windows</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. macOS users may need to use <code class="code">base64 -D</code>.</p></div></div>

       
      
    <div class="example"><h6>Example get-logs.sh script</h6><div class="example-contents"><p>In the same command prompt, use the following script to download the last five log events. The script uses <code class="code">sed</code> to remove quotes from the output file, and sleeps for 15 seconds to allow time for the logs to become available. The output includes the response from Lambda and the output from the <code class="code">get-log-events</code> command. </p><p>Copy the contents of the following code sample and save in your Lambda project directory as <code class="code">get-logs.sh</code>.</p><p>The <b>cli-binary-format</b> option is required if you're using AWS CLI version 2. To make this the default setting, run <code class="code">aws configure set cli-binary-format raw-in-base64-out</code>. For more information, see <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-options.html#cli-configure-options-list">AWS CLI supported global command line options</a>.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">#!/bin/bash
aws lambda invoke --function-name my-function --cli-binary-format raw-in-base64-out --payload '<span>{</span>"key": "value"}' out
sed -i'' -e 's/"//g' out
sleep 15
aws logs get-log-events --log-group-name /aws/lambda/<code class="replaceable">my-function</code> --log-stream-name <code class="replaceable">stream1</code> --limit 5</code></pre></div></div>
        <div class="example"><h6>Example macOS and Linux (only)</h6><div class="example-contents"><p>In the same command prompt, macOS and Linux users may need to run the following command to ensure the script is executable.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">chmod -R 755 get-logs.sh</code></code></pre></div></div>
        <div class="example"><h6>Example retrieve the last five log events</h6><div class="example-contents"><p>In the same command prompt, run the following script to get the last five log events.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">./get-logs.sh</code></code></pre><p>You should see the following output:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "StatusCode": 200,
    "ExecutedVersion": "$LATEST"
}
<span>{</span>
    "events": [
        <span>{</span>
            "timestamp": 1559763003171,
            "message": "START RequestId: 4ce9340a-b765-490f-ad8a-02ab3415e2bf Version: $LATEST\n",
            "ingestionTime": 1559763003309
        },
        <span>{</span>
            "timestamp": 1559763003173,
            "message": "2019-06-05T19:30:03.173Z\t4ce9340a-b765-490f-ad8a-02ab3415e2bf\tINFO\tENVIRONMENT VARIABLES\r<span>{</span>\r  \"AWS_LAMBDA_FUNCTION_VERSION\": \"$LATEST\",\r ...",
            "ingestionTime": 1559763018353
        },
        <span>{</span>
            "timestamp": 1559763003173,
            "message": "2019-06-05T19:30:03.173Z\t4ce9340a-b765-490f-ad8a-02ab3415e2bf\tINFO\tEVENT\r<span>{</span>\r  \"key\": \"value\"\r}\n",
            "ingestionTime": 1559763018353
        },
        <span>{</span>
            "timestamp": 1559763003218,
            "message": "END RequestId: 4ce9340a-b765-490f-ad8a-02ab3415e2bf\n",
            "ingestionTime": 1559763018353
        },
        <span>{</span>
            "timestamp": 1559763003218,
            "message": "REPORT RequestId: 4ce9340a-b765-490f-ad8a-02ab3415e2bf\tDuration: 26.73 ms\tBilled Duration: 27 ms \tMemory Size: 128 MB\tMax Memory Used: 75 MB\t\n",
            "ingestionTime": 1559763018353
        }
    ],
    "nextForwardToken": "f/34783877304859518393868359594929986069206639495374241795",
    "nextBackwardToken": "b/34783877303811383369537420289090800615709599058929582080"
}</code></pre></div></div>

   
    <h2 id="java-logging-delete">Deleting logs</h2>
     <p>Log groups aren't deleted automatically when you delete a function. To avoid storing logs indefinitely, delete
    the log group, or <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/Working-with-log-groups-and-streams.html#SettingLogRetention">configure
      a retention period</a> after which logs are deleted automatically.</p>  
    <h2 id="java-logging-log4j2">Advanced logging with Log4j 2 and SLF4J</h2>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>
        AWS Lambda does not include Log4j2 in its managed runtimes or base container images. 
        These are therefore not affected by the issues described in CVE-2021-44228, CVE-2021-45046, and CVE-2021-45105.
      </p><p>
        For cases where a customer function includes an impacted Log4j2 version, we have applied a change to the Lambda Java <a href="./lambda-runtimes.html">managed runtimes</a> and <a href="./java-image.html">base container images</a> that helps to mitigate the issues in CVE-2021-44228, CVE-2021-45046, and CVE-2021-45105. 
        As a result of this change, customers using Log4J2 may see an additional log entry, similar to "<code class="code">Transforming org/apache/logging/log4j/core/lookup/JndiLookup (java.net.URLClassLoader@...)</code>". 
        Any log strings that reference the jndi mapper in the Log4J2 output will be replaced with "<code class="code">Patched JndiLookup::lookup()</code>".
      </p><p>
        Independent of this change, we strongly encourage all customers whose functions include Log4j2 to update to the latest version. 
        Specifically, customers using the aws-lambda-java-log4j2 library in their functions should update to version 1.5.0 (or later), and redeploy their functions. 
        This version updates the underlying Log4j2 utility dependencies to version 2.17.0 (or later). The updated aws-lambda-java-log4j2 binary is available at the <a href="https://repo1.maven.org/maven2/com/amazonaws/aws-lambda-java-log4j2/" rel="noopener noreferrer" target="_blank"><span>Maven repository</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> and its source code is available in <a href="https://github.com/aws/aws-lambda-java-libs/tree/master/aws-lambda-java-log4j2" rel="noopener noreferrer" target="_blank"><span>Github</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.
      </p></div></div>
    
    <p>To customize log output, support logging during unit tests, and log AWS SDK calls, use Apache Log4j 2 with
      SLF4J. Log4j is a logging library for Java programs that enables you to configure log levels and use appender
      libraries. SLF4J is a facade library that lets you change which library you use without changing your function
      code.</p>
    
    <p>To add the request ID to your function's logs, use the appender in the <a href="./java-package.html">aws-lambda-java-log4j2</a> library. The following example shows a Log4j 2 configuration file that adds a
      timestamp and request ID to all logs.</p>
    <div class="example"><h6>Example <a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/sample-apps/s3-java/src/main/resources/log4j2.xml" rel="noopener noreferrer" target="_blank"><span>src/main/resources/log4j2.xml</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>
        – Appender configuration</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">&lt;Configuration packages="com.amazonaws.services.lambda.runtime.log4j2"&gt;
  <code class="userinput">&lt;Appenders&gt;
    &lt;Lambda name="Lambda"&gt;
      &lt;PatternLayout&gt;
          &lt;pattern&gt;%d<span>{</span>yyyy-MM-dd HH:mm:ss} %X<span>{</span>AWSRequestId} %-5p %c<span>{</span>1} - %m%n&lt;/pattern&gt;
      &lt;/PatternLayout&gt;
    &lt;/Lambda&gt;
  &lt;/Appenders&gt;</code>
  &lt;Loggers&gt;
    <code class="userinput">&lt;Root level="INFO"&gt;
      &lt;AppenderRef ref="Lambda"/&gt;
    &lt;/Root&gt;</code>
    &lt;Logger name="software.amazon.awssdk" level="WARN" /&gt;
    &lt;Logger name="software.amazon.awssdk.request" level="DEBUG" /&gt;
  &lt;/Loggers&gt;
&lt;/Configuration&gt;</code></pre></div></div>
    
    <p>With this configuration, each line is prepended with the date, time, request ID, log level, and class
      name.</p>
    <div class="example"><h6>Example log format with appender</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">START RequestId: 6bc28136-xmpl-4365-b021-0ce6b2e64ab0 Version: $LATEST
<code class="userinput">2020-03-18 08:52:43 6bc28136-xmpl-4365-b021-0ce6b2e64ab0 INFO  Handler -</code> ENVIRONMENT VARIABLES:
<span>{</span>
    "_HANDLER": "example.Handler",
    "AWS_EXECUTION_ENV": "AWS_Lambda_java8",
    "AWS_LAMBDA_FUNCTION_MEMORY_SIZE": "512",
    ...
}
<code class="userinput">2020-03-18 08:52:43 6bc28136-xmpl-4365-b021-0ce6b2e64ab0 INFO  Handler -</code> CONTEXT:
<span>{</span>
    "memoryLimit": 512,
    "awsRequestId": "6bc28136-xmpl-4365-b021-0ce6b2e64ab0",
    "functionName": "java-console",
    ...
}</code></pre></div></div>
    
    <p>SLF4J is a facade library for logging in Java code. In your function code, you use the SLF4J logger factory to
      retrieve a logger with methods for log levels like <code class="code">info()</code> and <code class="code">warn()</code>. In your build
      configuration, you include the logging library and SLF4J adapter in the classpath. By changing the libraries in
      the build configuration, you can change the logger type without changing your function code. SLF4J is required to
      capture logs from the SDK for Java.</p>
    <p>In the following example, the handler class uses SLF4J to retrieve a logger.</p>
    <div class="example"><h6>Example <a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/sample-apps/java-events/src/main/java/example/HandlerS3.java" rel="noopener noreferrer" target="_blank"><span>src/main/java/example/HandlerS3.java</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> – Logging with SLF4J</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="java "><code class="userinput">import org.slf4j.Logger;
import org.slf4j.LoggerFactory;</code>

// Handler value: example.Handler
public class HandlerS3 implements RequestHandler&lt;S3Event, String&gt;<span>{</span>
    <code class="userinput">private static final Logger logger = LoggerFactory.getLogger(HandlerS3.class);</code>
    Gson gson = new GsonBuilder().setPrettyPrinting().create();
    @Override
    public String handleRequest(S3Event event, Context context)
    <span>{</span>
        ...
        logger.info("RECORD: " + record);
        logger.info("SOURCE BUCKET: " + srcBucket);
        logger.info("SOURCE KEY: " + srcKey);
        ...
    }
}</code></pre></div></div>
    <p>The build configuration takes runtime dependencies on the Lambda appender and SLF4J adapter, and implementation
      dependencies on Log4J 2.</p>
    <div class="example"><h6>Example <a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/sample-apps/java-events/build.gradle" rel="noopener noreferrer" target="_blank"><span>build.gradle</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> – Logging
        dependencies</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">dependencies <span>{</span>
    ...
    <code class="userinput">implementation 'org.apache.logging.log4j:log4j-api:[2.17.1,)'
    implementation 'org.apache.logging.log4j:log4j-core:[2.17.1,)'
    implementation 'org.apache.logging.log4j:log4j-slf4j18-impl:[2.17.1,)'</code>
    ...
}</code></pre></div></div>
    
    <p>When you run your code locally for tests, the context object with the Lambda logger is not available, and
      there's no request ID for the Lambda appender to use. For example test configurations, see the sample applications
      in the next section.
      </p>
   
    <h2 id="java-logging-samples">Sample logging code</h2>
    
    <p>The GitHub repository for this guide includes sample applications that demonstrate the use of various logging
      configurations. Each sample application includes scripts for easy deployment and cleanup, an AWS SAM template, and
      supporting resources.</p>
    <div class="itemizedlist">
  <h6>Sample Lambda applications in Java</h6>
   
   
   
   
   
<ul class="itemizedlist"><li class="listitem">
    <p><a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/sample-apps/java17-examples" rel="noopener noreferrer" target="_blank"><span>java17-examples</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> – A Java function that
      demonstrates how to use a Java record to represent an input event data object.</p>
  </li><li class="listitem">
    <p><a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/sample-apps/java-basic" rel="noopener noreferrer" target="_blank"><span>java-basic</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> – A collection of minimal Java functions
      with unit tests and variable logging configuration.</p>
  </li><li class="listitem">
    <p><a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/sample-apps/java-events" rel="noopener noreferrer" target="_blank"><span>java-events</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> – A collection of Java functions that
      contain skeleton code for how to handle events from various services such as Amazon API Gateway, Amazon SQS, and Amazon Kinesis.
      These functions use the latest version of the <a href="./java-package.html">aws-lambda-java-events</a>
      library (3.0.0 and newer). These examples do not require the AWS SDK as a dependency.</p>
  </li><li class="listitem">
    <p><a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/main/sample-apps/s3-java" rel="noopener noreferrer" target="_blank"><span>s3-java</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> – A Java function that processes
      notification events from Amazon S3 and uses the Java Class Library (JCL) to create thumbnails from uploaded image
      files.</p>
  </li><li class="listitem">
    <p><a href="https://docs.aws.amazon.com/lambda/latest/dg/example_cross_LambdaAPIGateway_section.html">Use
      API Gateway to invoke a Lambda function</a> – A Java function that scans a Amazon DynamoDB table that
      contains employee information. It then uses Amazon Simple Notification Service to send a text message to employees celebrating
      their work anniversaries. This example uses API Gateway to invoke the function.</p>
  </li></ul></div>
    
    <p>The <code class="code">java-basic</code> sample application shows a minimal logging configuration that supports logging
      tests. The handler code uses the <code class="code">LambdaLogger</code> logger provided by the context object. For tests, the
      application uses a custom <code class="code">TestLogger</code> class that implements the <code class="code">LambdaLogger</code> interface
      with a Log4j 2 logger. It uses SLF4J as a facade for compatibility with the AWS SDK. Logging libraries are
      excluded from build output to keep the deployment package small.</p>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./java-context.html">Context</div><div id="next" class="next-link" accesskey="n" href="./java-exceptions.html">Errors</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/java-logging.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/java-logging.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>