<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Lambda execution role - AWS Lambda</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="lambda-intro-execution-role" /><meta name="default_state" content="lambda-intro-execution-role" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html" /><meta name="description" content="Learn how to manage permissions for your Lambda function's execution role." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Lambda" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="" /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html" hreflang="x-default" /><meta name="feedback-item" content="Lambda" /><meta name="this_doc_product" content="AWS Lambda" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'lambda'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Lambda execution role" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Lambda execution role - AWS Lambda</title><meta name="pdf" content="/pdfs/lambda/latest/dg/lambda-dg.pdf#lambda-intro-execution-role" /><meta name="rss" content="lambda-updates.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=186" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/lambda-intro-execution-role.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/lambda-intro-execution-role.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/lambda/latest/dg/lambda-intro-execution-role.html" /><meta name="keywords" content="Lambda,AWS Lambda,serverless,serverless applications,cloud computing,permissions,grant access to function,policy,add permission,function permissions,allow access to other resources,allow access to bucket,allow access to database,function access permissions" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Lambda",
        "item" : "https://docs.aws.amazon.com/lambda/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Lambda resource access permissions",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/lambda-permissions.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Lambda execution role",
        "item" : "https://docs.aws.amazon.com/lambda/latest/dg/lambda-permissions.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/lambda/latest/dg/lambda-dg.pdf#lambda-intro-execution-role" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/lambda/index.html">AWS Lambda</a><a href="welcome.html">Developer Guide</a></div><div id="page-toc-src"><a href="#permissions-executionrole-console">Creating an execution role in the IAM console</a><a href="#permissions-executionrole-least-privilege">Grant least privilege access to your Lambda execution role</a><a href="#permissions-executionrole-api">Managing roles with the IAM API</a><a href="#permissions-executionrole-session">Session duration for temporary security credentials</a><a href="#permissions-executionrole-features">AWS managed policies for Lambda features</a><a href="#permissions-executionrole-source-function-arn">Working with Lambda execution environment credentials</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="lambda-intro-execution-role">Lambda execution role</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>A Lambda function's execution role is an AWS Identity and Access Management (IAM) role that grants the function permission to access
    AWS services and resources. For example, you might create an execution role that has permission to send logs to
    Amazon CloudWatch and upload trace data to AWS X-Ray. This page provides information on how to create, view, and manage a
    Lambda function's execution role.</p><p>You provide an execution role when you create a function. <b>When you invoke your function,
    Lambda automatically provides your function with temporary credentials by assuming this role.</b> You don't
    have to call <code class="code">sts:AssumeRole</code> in your function code.</p><p>In order for Lambda to properly assume your execution role, <b>the role's
    <a href="#permissions-executionrole-api">trust policy</a> must specify the Lambda service principal
    (<code class="code">lambda.amazonaws.com</code>) as a trusted service.</b></p><div class="procedure"><h6>To view a function's execution role</h6><ol><li><p>Open the <a href="https://console.aws.amazon.com/lambda/home#/functions" rel="noopener noreferrer" target="_blank"><span>Functions page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> of the Lambda console.</p></li><li>
      <p>Choose the name of a function.</p>
    </li><li>
      <p>Choose <b>Configuration</b>, and then choose <b>Permissions</b>.</p>
    </li><li>
      <p>Under <b>Resource summary</b>, review the services and resources that the function can
        access.</p>
    </li><li>
      <p>Choose a service from the dropdown list to see permissions related to that service.</p>
    </li></ol></div><p>You can add or remove permissions from a function's execution role at any time, or configure
    your function to use a different role. Add permissions for any services that your function calls
    with the AWS SDK, and for services that Lambda uses to enable optional features.</p><p>When you add permissions to your function, update its code or configuration as well. This forces
    running instances of your function, which have outdated credentials, to stop and be replaced.</p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#permissions-executionrole-console">Creating an execution role in the IAM console</a></li><li><a href="#permissions-executionrole-least-privilege">Grant least privilege access to your Lambda execution role</a></li><li><a href="#permissions-executionrole-api">Managing roles with the IAM API</a></li><li><a href="#permissions-executionrole-session">Session duration for temporary security credentials</a></li><li><a href="#permissions-executionrole-features">AWS managed policies for Lambda features</a></li><li><a href="#permissions-executionrole-source-function-arn">Working with Lambda execution environment credentials</a></li></ul></div>
    <h2 id="permissions-executionrole-console">Creating an execution role in the IAM console</h2>
    
    <p>By default, Lambda creates an execution role with minimal permissions when you <a href="./getting-started.html#getting-started-create-function">create a function in the Lambda console</a>. You can also create an
      execution role in the IAM console.</p>
    <div class="procedure"><h6>To create an execution role in the IAM console</h6><ol><li>
        <p>Open the <a href="https://console.aws.amazon.com/iam/home#/roles" rel="noopener noreferrer" target="_blank"><span>Roles page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> in the IAM console.</p>
      </li><li>
        <p>Choose <b>Create role</b>.</p>
      </li><li>
        <p>Under <b>Use case</b>, choose <b>Lambda</b>.</p>
      </li><li>
        <p>Choose <b>Next</b>.</p>
      </li><li>
        <p>Select the AWS managed policies
          <b>AWSLambdaBasicExecutionRole</b> and <b>AWSXRayDaemonWriteAccess</b>.</p>
      </li><li>
        <p>Choose <b>Next</b>.</p>
      </li><li>
        <p>Enter a <b>Role name</b> and then choose <b>Create role</b>.</p>
      </li></ol></div>
    <p>For detailed instructions, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-service.html#roles-creatingrole-service-console">Creating a role
      for an AWS service (console)</a> in the <em>IAM User Guide</em>.</p>
   
    <h2 id="permissions-executionrole-least-privilege">Grant least privilege access to your Lambda execution role</h2>
    <p>When you first create an IAM role for your Lambda function during the development phase, you might sometimes
      grant permissions beyond what is required. Before publishing your function in the production environment, as a
      best practice, adjust the policy to include only the required permissions. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">Apply least-privilege
        permissions</a> in the <em>IAM User Guide</em>.</p>
    <p>Use IAM Access Analyzer to help identify the required permissions for the IAM execution role policy. IAM Access Analyzer
      reviews your AWS CloudTrail logs over the date range that you specify and generates a policy template with only the
      permissions that the function used during that time. You can use the template to create a managed policy with
      fine-grained permissions, and then attach it to the IAM role. That way, you grant only the permissions that the
      role needs to interact with AWS resources for your specific use case.</p>
    <p>For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_generate-policy.html">Generate policies based on access
        activity</a> in the <em>IAM User Guide</em>.</p>
   
    <h2 id="permissions-executionrole-api">Managing roles with the IAM API</h2>
    <p>To create an execution role with the AWS Command Line Interface (AWS CLI), use the <b>create-role</b> command. When using this
      command, you can specify the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#delegation">
      trust policy</a> inline. A role's trust policy gives the specified principals permission to assume the role. In the
      following example, you grant the Lambda service principal permission to assume your role. Note that requirements for escaping
      quotes in the JSON string may vary depending on your shell.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws iam create-role --role-name lambda-ex --assume-role-policy-document '<span>{</span>"Version": "2012-10-17","Statement": [<span>{</span> "Effect": "Allow", "Principal": <span>{</span>"Service": "lambda.amazonaws.com"}, "Action": "sts:AssumeRole"}]}'</code></code></pre>
    
    <p>You can also define the trust policy for the role using a separate JSON file. In the following example,
      <code>trust-policy.json</code> is a file in the current directory.</p>
    <div class="example"><h6>Example trust-policy.json</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Principal": <span>{</span>
        "Service": "lambda.amazonaws.com"
      },
      "Action": "sts:AssumeRole"
    }
  ]
}</code></pre><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws iam create-role --role-name lambda-ex --assume-role-policy-document file://trust-policy.json</code></code></pre></div></div>
    <p>You should see the following output:</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Role": <span>{</span>
        "Path": "/",
        "RoleName": "lambda-ex",
        "RoleId": "AROAQFOXMPL6TZ6ITKWND",
        "Arn": "arn:aws:iam::123456789012:role/lambda-ex",
        "CreateDate": "2020-01-17T23:19:12Z",
        "AssumeRolePolicyDocument": <span>{</span>
            "Version": "2012-10-17",
            "Statement": [
                <span>{</span>
                    "Effect": "Allow",
                    "Principal": <span>{</span>
                        "Service": "lambda.amazonaws.com"
                    },
                    "Action": "sts:AssumeRole"
                }
            ]
        }
    }
}</code></pre>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Lambda automatically assumes your execution role when you invoke your function. You should avoid calling
      <code class="code">sts:AssumeRole</code> manually in your function code. If your use case requires that the role assumes itself,
      you must include the role itself as a trusted principal in your role's trust policy. For more information on how to
      modify a role trust policy, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/roles-managingrole-editing-console.html#roles-managingrole_edit-trust-policy">
      Modifying a role trust policy (console)</a> in the IAM User Guide.</p></div></div>
    <p>To add permissions to the role, use the <b>attach-policy-to-role</b> command. Start by adding the
      <code class="code">AWSLambdaBasicExecutionRole</code> managed policy.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws iam attach-role-policy --role-name lambda-ex --policy-arn arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole</code></code></pre>
   
      <h2 id="permissions-executionrole-session">Session duration for temporary security credentials</h2>
      <p>Lambda assumes the execution role associated with your function to fetch temporary security credentials which are then available as environment variables during a function's invocation. If you use these temporary credentials outside of Lambda, such as to create a presigned Amazon S3 URL, you can't control the session duration. The IAM maximum session duration setting doesn't apply to sessions that are assumed by AWS services such as Lambda. Use the <a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html">sts:AssumeRole</a> action if you need control over session duration.</p>
     
    <h2 id="permissions-executionrole-features">AWS managed policies for Lambda features</h2>
    
    <p>The following AWS managed policies provide permissions that are required to use Lambda features.</p>
    <div class="table-container"><div class="table-contents"><table id="w917aac89c33c43b7"><thead>
          <tr>
            <th>Change</th>
            <th>Description</th>
            <th>Date</th>
          </tr>
        </thead>
          <tr>
            <td tabindex="-1">
              <p><b><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/service-role/AWSLambdaMSKExecutionRole" rel="noopener noreferrer" target="_blank"><span>
                AWSLambdaMSKExecutionRole</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – Lambda added the <a href="https://docs.aws.amazon.com/MSK/2.0/APIReference/v2-clusters-clusterarn.html#v2-clusters-clusterarnget">kafka:DescribeClusterV2</a> permission to this policy.</p>
            </td>
            <td tabindex="-1">
              <p><code class="code">AWSLambdaMSKExecutionRole</code> grants permissions to read and access records from an Amazon Managed Streaming for Apache Kafka (Amazon MSK)
                cluster, manage elastic network interfaces (ENIs), and write to CloudWatch Logs.</p>
            </td>
            <td tabindex="-1">
              <p>June 17, 2022</p>
            </td>
          </tr>
          <tr>
            <td tabindex="-1">
              <p><b><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole" rel="noopener noreferrer" target="_blank"><span>
                AWSLambdaBasicExecutionRole</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – Lambda started tracking changes to this policy.</p>
            </td>
            <td tabindex="-1">
              <p><code class="code">AWSLambdaBasicExecutionRole</code> grants permissions to upload logs to CloudWatch.</p>
            </td>
            <td tabindex="-1">
              <p>February 14, 2022</p>
            </td>
          </tr>
          <tr>
            <td tabindex="-1">
              <p><b><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/service-role/AWSLambdaDynamoDBExecutionRole" rel="noopener noreferrer" target="_blank"><span>
                AWSLambdaDynamoDBExecutionRole</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – Lambda started tracking changes to this policy.</p>
            </td>
            <td tabindex="-1">
              <p><code class="code">AWSLambdaDynamoDBExecutionRole</code> grants permissions to read records from an Amazon DynamoDB stream and write to CloudWatch Logs.</p>
            </td>
            <td tabindex="-1">
              <p>February 14, 2022</p>
            </td>
          </tr>
          <tr>
            <td tabindex="-1">
              <p><b><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/service-role/AWSLambdaKinesisExecutionRole" rel="noopener noreferrer" target="_blank"><span>
                AWSLambdaKinesisExecutionRole</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – Lambda started tracking changes to this policy.</p>
            </td>
            <td tabindex="-1">
              <p><code class="code">AWSLambdaKinesisExecutionRole</code> grants permissions to read events from an Amazon Kinesis data stream and write to CloudWatch Logs.</p>
            </td>
            <td tabindex="-1">
              <p>February 14, 2022</p>
            </td>
          </tr>
          <tr>
            <td tabindex="-1">
              <p><b><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/service-role/AWSLambdaMSKExecutionRole" rel="noopener noreferrer" target="_blank"><span>
                AWSLambdaMSKExecutionRole</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – Lambda started tracking changes to this policy.</p>
            </td>
            <td tabindex="-1">
              <p><code class="code">AWSLambdaMSKExecutionRole</code> grants permissions to read and access records from an Amazon Managed Streaming for Apache Kafka (Amazon MSK)
                cluster, manage elastic network interfaces (ENIs), and write to CloudWatch Logs.</p>
            </td>
            <td tabindex="-1">
              <p>February 14, 2022</p>
            </td>
          </tr>
          <tr>
            <td tabindex="-1">
              <p><b><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/service-role/AWSLambdaSQSQueueExecutionRole" rel="noopener noreferrer" target="_blank"><span>
                AWSLambdaSQSQueueExecutionRole</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – Lambda started tracking changes to this policy.</p>
            </td>
            <td tabindex="-1">
              <p><code class="code">AWSLambdaSQSQueueExecutionRole</code> grants permissions to read a message from an Amazon Simple Queue Service (Amazon SQS) queue and write to CloudWatch Logs.</p>
            </td>
            <td tabindex="-1">
              <p>February 14, 2022</p>
            </td>
          </tr>
          <tr>
            <td tabindex="-1">
              <p><b><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole" rel="noopener noreferrer" target="_blank"><span>
                AWSLambdaVPCAccessExecutionRole</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – Lambda started tracking changes to this policy.</p>
            </td>
            <td tabindex="-1">
              <p><code class="code">AWSLambdaVPCAccessExecutionRole</code> grants permissions to manage ENIs within an Amazon VPC and write to CloudWatch Logs.</p>
            </td>
            <td tabindex="-1">
              <p>February 14, 2022</p>
            </td>
          </tr>
          <tr>
            <td tabindex="-1">
              <p><b><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/AWSXRayDaemonWriteAccess" rel="noopener noreferrer" target="_blank"><span>
                AWSXRayDaemonWriteAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – Lambda started tracking changes to this policy.</p>
            </td>
            <td tabindex="-1">
              <p><code class="code">AWSXRayDaemonWriteAccess</code> grants permissions to upload trace data to X-Ray.</p>
            </td>
            <td tabindex="-1">
              <p>February 14, 2022</p>
            </td>
          </tr>
          <tr>
            <td tabindex="-1">
              <p><b><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/CloudWatchLambdaInsightsExecutionRolePolicy" rel="noopener noreferrer" target="_blank"><span>
                CloudWatchLambdaInsightsExecutionRolePolicy</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – Lambda started tracking changes to this policy.</p>
            </td>
            <td tabindex="-1">
              <p><code class="code">CloudWatchLambdaInsightsExecutionRolePolicy</code> grants permissions to write runtime metrics to CloudWatch Lambda Insights.</p>
            </td>
            <td tabindex="-1">
              <p>February 14, 2022</p>
            </td>
          </tr>
          <tr>
            <td tabindex="-1">
              <p><b><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/service-role/AmazonS3ObjectLambdaExecutionRolePolicy" rel="noopener noreferrer" target="_blank"><span>
                AmazonS3ObjectLambdaExecutionRolePolicy</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – Lambda started tracking changes to this policy.</p>
            </td>
            <td tabindex="-1">
              <p><code class="code">AmazonS3ObjectLambdaExecutionRolePolicy</code> grants permissions to interact with Amazon Simple Storage Service
                (Amazon S3) object Lambda and to write to CloudWatch Logs.</p>
            </td>
            <td tabindex="-1">
              <p>February 14, 2022</p>
            </td>
          </tr>
        </table></div></div>
    
    <p>For some features, the Lambda console attempts to add missing permissions to your execution role in a customer
      managed policy. These policies can become numerous. To avoid creating extra policies, add the relevant AWS
      managed policies to your execution role before enabling features.</p>
    
    <p>When you use an <a href="./invocation-eventsourcemapping.html">event source mapping</a> to invoke your
      function, Lambda uses the execution role to read event data. For example, an event source mapping for Kinesis reads
      events from a data stream and sends them to your function in batches. </p>
    <p>When a service assumes a role in your account, you can include the <code class="code">aws:SourceAccount</code> and <code class="code">aws:SourceArn</code> global 
      condition context keys in your role trust policy to limit access to the role to only requests that are generated by expected resources. For more 
      information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html#cross-service-confused-deputy-prevention">Cross-service 
      confused deputy prevention for AWS Security Token Service</a>.</p>
    <p>You can use event source mappings with the following services:</p>
    <div class="itemizedlist">
  <h6>Services that Lambda reads events from</h6>
   
   
   
   
   
   
   
<ul class="itemizedlist"><li class="listitem">
    <p><a href="./with-ddb.html">Amazon DynamoDB</a></p>
  </li><li class="listitem">
    <p><a href="./with-kinesis.html">Amazon Kinesis</a></p>
  </li><li class="listitem">
    <p><a href="./with-mq.html">Amazon MQ</a></p>
  </li><li class="listitem">
    <p><a href="./with-msk.html">Amazon Managed Streaming for Apache Kafka (Amazon MSK)</a></p>
  </li><li class="listitem">
    <p><a href="./with-kafka.html">Self-managed Apache Kafka</a></p>
  </li><li class="listitem">
    <p><a href="./with-sqs.html">Amazon Simple Queue Service (Amazon SQS)</a></p>
  </li><li class="listitem">
    <p><a href="./with-documentdb.html">Amazon DocumentDB (with MongoDB compatibility) (Amazon DocumentDB)</a></p>
  </li></ul></div>
    
    <p>In addition to the AWS managed policies, the Lambda console provides templates for creating a custom policy
      with permissions for additional use cases. When you create a function in the Lambda console, you can choose to
      create a new execution role with permissions from one or more templates. These templates are also applied
      automatically when you create a function from a blueprint, or when you configure options that require access to
      other services. Example templates are available in this guide's <a href="https://github.com/awsdocs/aws-lambda-developer-guide/tree/master/iam-policies" rel="noopener noreferrer" target="_blank"><span>GitHub
        repository</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
   
    <h2 id="permissions-executionrole-source-function-arn">Working with Lambda execution environment credentials</h2>
    <p>It's common for your Lambda function code to make API requests to other AWS services. To make these
      requests, Lambda generates an ephemeral set of credentials by assuming your function's execution role. These
      credentials are available as environment variables during your function's invocation. When working with AWS
      SDKs, you don't need to provide credentials for the SDK directly in code. By default, the credential provider
      chain sequentially checks each place where you can set credentials and selects the first one available—usually
      the environment variables (<code class="code">AWS_ACCESS_KEY_ID</code>, <code class="code">AWS_SECRET_ACCESS_KEY</code>,
      and <code class="code">AWS_SESSION_TOKEN</code>).</p>
    <p>Lambda injects the source function ARN into the credentials context if the request is an AWS API request
      that comes from within your execution environment. Lambda also injects the source function ARN for the following
      AWS API requests that Lambda makes on your behalf outside of your execution environment:</p>
    <div class="table-container"><div class="table-contents"><table id="w917aac89c33c47b7"><thead>
          <tr>
            <th>Service</th>
            <th>Action</th>
            <th>Reason</th>
          </tr>
        </thead>
          <tr>
            <td tabindex="-1">CloudWatch Logs</td>
            <td tabindex="-1"><code class="code">CreateLogGroup</code>, <code class="code">CreateLogStream</code>, <code class="code">PutLogEvents</code></td>
            <td tabindex="-1">
              <p>To store logs into a CloudWatch Logs log group</p>
            </td>
          </tr>
          <tr>
            <td tabindex="-1">X-Ray</td>
            <td tabindex="-1"><code class="code">PutTraceSegments</code></td>
            <td tabindex="-1">
              <p>To send trace data to X-Ray</p>
            </td>
          </tr>
          <tr>
            <td tabindex="-1">Amazon EFS</td>
            <td tabindex="-1"><code class="code">ClientMount</code></td>
            <td tabindex="-1">
              <p>To connect your function to an Amazon Elastic File System (Amazon EFS) file system</p>
            </td>
          </tr>
        </table></div></div>
    <p>Other AWS API calls that Lambda makes outside of your execution environment on your behalf using the same
      execution role don't contain the source function ARN. Examples of such API calls outside the execution environment
      include:</p>
    <div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>Calls to AWS Key Management Service (AWS KMS) to automatically encrypt and decrypt your environment variables.</p>
      </li><li class="listitem">
        <p>Calls to Amazon Elastic Compute Cloud (Amazon EC2) to create elastic network interfaces (ENIs) for a VPC-enabled function.</p>
      </li><li class="listitem">
        <p>Calls to AWS services, such as Amazon Simple Queue Service (Amazon SQS), to read from an event source that's set up as an
          <a href="./invocation-eventsourcemapping.html">event source mapping</a>.</p>
      </li></ul></div>
    <p>With the source function ARN in the credentials context, you can verify whether a call to your resource came
      from a specific Lambda function's code. To verify this, use the <code class="code">lambda:SourceFunctionArn</code> condition key
      in an IAM identity-based policy or service control policy (SCP).</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You cannot use the <code class="code">lambda:SourceFunctionArn</code> condition key in resource-based policies.</p></div></div>
    <p>With this condition key in your identity-based policies or SCPs, you can implement
      security controls for the API actions that your function code makes to other AWS services. This has a few key
      security applications, such as helping you identify the source of a credential leak.</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The <code class="code">lambda:SourceFunctionArn</code> condition key is different from the <code class="code">lambda:FunctionArn</code>
        and <code class="code">aws:SourceArn</code> condition keys. The <code class="code">lambda:FunctionArn</code> condition key applies only to <a href="./invocation-eventsourcemapping.html">event source mappings</a> and helps define which functions your
        event source can invoke. The <code class="code">aws:SourceArn</code> condition key applies only to policies where your Lambda
        function is the target resource, and helps define which other AWS services and resources can invoke that function. The
        <code class="code">lambda:SourceFunctionArn</code> condition key can apply to any identity-based policy or SCP to define the
        specific Lambda functions that have permissions to make specific AWS API calls to other resources.</p></div></div>
    <p>To use <code class="code">lambda:SourceFunctionArn</code> in your policy, include it as a
      condition with any of the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_condition_operators.html#Conditions_ARN">ARN
      condition operators</a>. The value of the key must be a valid ARN.</p>
    <p>For example, suppose your Lambda function code makes an <code class="code">s3:PutObject</code> call that targets a specific
      Amazon S3 bucket. You might want to allow only one specific Lambda function to have <code class="code">s3:PutObject</code> access
      that bucket. In this case, your function's execution role should have a policy attached that looks like this:</p>
    <div class="example"><h6>Example policy granting a specific Lambda function access to an Amazon S3 resource</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "ExampleSourceFunctionArn",
            "Effect": "Allow",
            "Action": "s3:PutObject",
            "Resource": "arn:aws:s3:::lambda_bucket/*",
            "Condition": <span>{</span>
                "ArnEquals": <span>{</span>
                    "lambda:SourceFunctionArn": "arn:aws:lambda:us-east-1:123456789012:function:source_lambda"
                }
            }
        }
    ]
}</code></pre></div></div>
    <p>This policy allows only <code class="code">s3:PutObject</code> access if the source is the Lambda function with ARN
        <code class="code">arn:aws:lambda:us-east-1:123456789012:function:source_lambda</code>. This policy doesn't allow
        <code class="code">s3:PutObject</code> access to any other calling identity. This is true even if a different function or
      entity makes an <code class="code">s3:PutObject</code> call with the same execution role.</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The <code class="code">lambda:SourceFunctionARN</code> condition key doesn't support Lambda function versions or function aliases. 
      If you use the ARN for a particular function version or alias, your function won't have permission to take the action you specify. 
      Be sure to use the unqualified ARN for your function without a version or alias suffix.</p></div></div>
    <p>You can also use <code class="code">lambda:SourceFunctionArn</code> in <a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html">service control policies</a>. For example,
      suppose you want to restrict access to your bucket to either a single Lambda function's code or to calls from a
      specific Amazon Virtual Private Cloud (VPC). The following SCP illustrates this.</p>
    <div class="example"><h6>Example policy denying access to Amazon S3 under specific conditions</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Action": [
                "s3:*"
            ],
            "Resource": "arn:aws:s3:::lambda_bucket/*",
            "Effect": "Deny",
            "Condition": <span>{</span>
                "StringNotEqualsIfExists": <span>{</span>
                    "aws:SourceVpc": [
                        "vpc-12345678"
                    ]
                },
                "ArnNotEqualsIfExists": <span>{</span>
                    "lambda:SourceFunctionArn": "arn:aws:lambda:us-east-1:123456789012:function:source_lambda"
                }
            }
        }
    ]
}</code></pre></div></div>
    <p>This policy denies all S3 actions unless they come from a specific Lambda function with ARN
        <code class="code">arn:aws:lambda:*:123456789012:function:source_lambda</code>, or unless they come from the specified VPC.
        The <code class="code">StringNotEqualsIfExists</code> operator tells IAM to process this condition only if the
        <code class="code">aws:SourceVpc</code> key is present in the request. Similarly, IAM considers the
        <code class="code">ArnNotEqualsIfExists</code> operator only if the <code class="code">lambda:SourceFunctionArn</code> exists.</p>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./lambda-permissions.html">Access permissions</div><div id="next" class="next-link" accesskey="n" href="./access-control-identity-based.html">User policies</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/lambda-intro-execution-role.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lambda&amp;topic_url=https://docs.aws.amazon.com/en_us/lambda/latest/dg/lambda-intro-execution-role.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>